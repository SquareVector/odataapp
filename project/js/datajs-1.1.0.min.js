(function(i8,iX){var a0=i8.datajs||{},i1=i8.OData||{},bX,gj,fT,dA,h6;typeof define=="function"&&define.amd?(define("datajs",a0),define("OData",i1)):(i8.datajs=a0,i8.OData=i1);var c1=function(a){return i8.ActiveXObject?new i8.ActiveXObject(a):null},jV=function(a){return a!==null&&a!==iX},aU=function(d,b){for(var a=0,c=d.length;a<c;a++){if(d[a]===b){return !0}}return !1},d1=function(b,a){return b!==iX?b:a},i7=function(b){if(arguments.length===1){i8.setTimeout(b,0);return}var a=Array.prototype.slice.call(arguments,1);i8.setTimeout(function(){b.apply(this,a)},0)},bx=function(c,b){for(var a in b){c[a]=b[a]}return c},g9=function(d,b){if(d){for(var a=0,c=d.length;a<c;a++){if(b(d[a])){return d[a]}}}return null},jo=function(a){return Object.prototype.toString.call(a)==="[object Array]"},gC=function(a){return Object.prototype.toString.call(a)==="[object Date]"},jj=function(a){return typeof a=="object"},iZ=function(a){return parseInt(a,10)},fK=function(c,b,a){c.hasOwnProperty(b)&&(c[a]=c[b],delete c[b])},cx=function(a){throw a},E=function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},eS=function(b,a){return b!==iX?b:a},gI=/^([^:\/?#]+:)?(\/\/[^\/?#]*)?([^?#:]+)?(\?[^#]*)?(#.*)?/,jE=["scheme","authority","path","query","fragment"],j6=function(e){var c={isAbsolute:!1},d,b,a;if(e){if(d=gI.exec(e),d){for(b=0,a=jE.length;b<a;b++){d[b+1]&&(c[jE[b]]=d[b+1])}}c.scheme&&(c.isAbsolute=!0)}return c},e6=function(a){return"".concat(a.scheme||"",a.authority||"",a.path||"",a.query||"",a.fragment||"")},d4=/^\/{0,2}(?:([^@]*)@)?([^:]+)(?::{1}(\d+))?/,bB=/%[0-9A-F]{2}/ig,fO=function(e){var c=j6(e),d=c.scheme,a=c.authority,b;return d&&(c.scheme=d.toLowerCase(),a&&(b=d4.exec(a),b&&(c.authority="//"+(b[1]?b[1]+"@":"")+b[2].toLowerCase()+(b[3]?":"+b[3]:"")))),e=e6(c),e.replace(bB,function(f){return f.toLowerCase()})},jh=function(g,c){var b,a,d,e;return c?(b=j6(g),b.isAbsolute)?g:(a=j6(c),d={},b.authority?(d.authority=b.authority,e=b.path,d.query=b.query):(b.path?(e=b.path.charAt(0)==="/"?b.path:cC(b.path,a.path),d.query=b.query):(e=a.path,d.query=b.query||a.query),d.authority=a.authority),d.path=aV(e),d.scheme=a.scheme,d.fragment=b.fragment,e6(d)):g},cC=function(d,b){var a="/",c;return b&&(c=b.lastIndexOf("/"),a=b.substring(0,c),a.charAt(a.length-1)!=="/"&&(a=a+"/")),a+d},aV=function(d){for(var b="",c="",a;d;){d.indexOf("..")===0||d.indexOf(".")===0?d=d.replace(/^\.\.?\/?/g,""):d.indexOf("/..")===0?(d=d.replace(/^\/\..\/?/g,"/"),a=b.lastIndexOf("/"),b=a===-1?"":b.substring(0,a)):d.indexOf("/.")===0?d=d.replace(/^\/\.\/?/g,"/"):(c=d,a=d.indexOf("/",1),a!==-1&&(c=d.substring(0,a)),b=b+c,d=d.replace(c,""))}return b},aQ="http://",hP=aQ+"www.w3.org/",gQ=hP+"1999/xhtml",dH=hP+"2000/xmlns/",eP=hP+"XML/1998/namespace",d2=aQ+"www.mozilla.org/newlayout/xml/parsererror.xml",hj=function(b){var a=/(^\s)|(\s$)/;return a.test(b)},hR=function(b){var a=/^\s*$/;return b===null||a.test(b)},dI=function(b){while(b!==null&&b.nodeType===1){var a=hN(b,"space",eP);if(a==="preserve"){return !0}if(a==="default"){break}else{b=b.parentNode}}return !1},bW=function(b){var a=b.nodeName;return a=="xmlns"||a.indexOf("xmlns:")==0},g6=function(d,b,a){try{d.setProperty(b,a)}catch(c){}},f9=function(){var a=c1("Msxml2.DOMDocument.3.0");return a&&(g6(a,"ProhibitDTD",!0),g6(a,"MaxElementDepth",256),g6(a,"AllowDocumentFunction",!1),g6(a,"AllowXsltScript",!1)),a},bz=function(){try{var b=c1("Msxml2.DOMDocument.6.0");return b&&(b.async=!0),b}catch(a){return f9()}},i2=function(c){var b=bz(),a;return b?(b.loadXML(c),a=b.parseError,a.errorCode!==0&&bV(a.reason,a.srcText,c),b):null},bV=function(c,b,a){typeof c=="string"&&(c={message:c});throw bx(c,{srcText:b||"",errorXmlText:a||""})},hM=function(ab){var ac=i8.DOMParser&&new i8.DOMParser,b,n,f;if(!ac){return b=i2(ab),b||bV("XML DOM parser not supported"),b}try{b=ac.parseFromString(ab,"text/xml")}catch(y){bV(y,"",ab)}var g=b.documentElement,k=g.namespaceURI,p=jl(g);if(p==="parsererror"&&k===d2&&(n=iS(g,d2,"sourcetext"),f=n?kJ(n):"",bV(ju(g)||"",f,ab)),p==="h3"&&k===gQ||aq(g,gQ,"h3")){for(var d="",w=[],aa=g.firstChild;aa;){aa.nodeType===1&&(d+=ju(aa)||""),w.push(aa.nextSibling),aa=aa.firstChild||w.shift()}d+=ju(g)||"",bV(d,"",ab)}return b},Y=function(b,a){return b?b+":"+a:a},eK=function(c,b){if(hj(b.data)){var a=aC(c,eP,"space");a||(a=hA(c.ownerDocument,eP,Y("xml","space")),jr(c,a)),a.value="preserve"}return c.appendChild(b),c},j3=function(e,c){for(var d=e.attributes,b=0,a=d.length;b<a;b++){c(d.item(b))}},hN=function(d,b,a){var c=aC(d,b,a);return c?kJ(c):null},aC=function(d,b,a){var c=d.attributes;return c.getNamedItemNS?c.getNamedItemNS(a||null,b):c.getQualifiedItem(b,a)||null},fL=function(c,b){var a=aC(c,"base",eP);return(a?jh(a.value,b):b)||null},iO=function(b,a){aG(b,!1,function(c){return c.nodeType===1&&a(c),!0})},fM=function(g,c,b){for(var a=b.split("/"),d=0,e=a.length;d<e;d++){g=g&&iS(g,c,a[d])}return g||null},jY=function(k,c,b){var g=b.lastIndexOf("/"),d=b.substring(g+1),h=b.substring(0,g),a=h?fM(k,c,h):k;return a?d.charAt(0)==="@"?aC(a,d.substring(1),c):iS(a,c,d):null},iS=function(c,b,a){return cA(c,b,a,!1)},aq=function(d,b,a){if(d.getElementsByTagNameNS){var c=d.getElementsByTagNameNS(b,a);return c.length>0?c[0]:null}return cA(d,b,a,!0)},cA=function(f,b,a,c){var d=null;return aG(f,c,function(h){if(h.nodeType===1){var e=!b||iV(h)===b,g=!a||jl(h)===a;e&&g&&(d=h)}return d===null}),d},ju=function(e){var b=null,c=e.nodeType===9&&e.documentElement?e.documentElement:e,d=c.ownerDocument.preserveWhiteSpace===!1,a;return aG(c,!1,function(h){if(h.nodeType===3||h.nodeType===4){var f=kJ(h),g=d||!hR(f);g||(a===iX&&(a=dI(c)),g=a),g&&(b?b+=f:b=f)}return !0}),b},jl=function(a){return a.localName||a.baseName},iV=function(a){return a.namespaceURI||null},kJ=function(a){return a.nodeType===1?ju(a):a.nodeValue},aG=function(g,c,b){for(var e=[],d=g.firstChild,a=!0;d&&a;){a=b(d),a&&(c&&d.firstChild&&e.push(d.firstChild),d=d.nextSibling||e.shift())}},kE=function(g,b,a){for(var c=g.nextSibling,d,f;c;){if(c.nodeType===1&&(d=!b||iV(c)===b,f=!a||jl(c)===a,d&&f)){return c}c=c.nextSibling}return null},aT=function(){var a=i8.document.implementation;return a&&a.createDocument?a.createDocument(null,null,null):bz()},dE=function(d,b){if(!jo(b)){return jr(d,b)}for(var a=0,c=b.length;a<c;a++){b[a]&&jr(d,b[a])}return d},jr=function(b,a){if(a){if(typeof a=="string"){return eK(b,D(b.ownerDocument,a))}a.nodeType===2?b.setAttributeNodeNS?b.setAttributeNodeNS(a):b.setAttributeNode(a):b.appendChild(a)}return b},hA=function(e,b,c,a){var d=e.createAttributeNS&&e.createAttributeNS(b,c)||e.createNode(2,c,b||iX);return d.value=a||"",d},f8=function(e,b,c,a){var d=e.createElementNS&&e.createElementNS(b,c)||e.createNode(1,c,b||iX);return dE(d,a||[])},g8=function(c,b,a){return hA(c,dH,Y("xmlns",a),b)},c0=function(l,c){for(var g="<c>"+c+"</c>",h=hM(g),d=h.documentElement,k=("importNode" in l)?l.importNode(d,!0):d,a=l.createDocumentFragment(),b=k.firstChild;b;){a.appendChild(b),b=b.nextSibling}return a},D=function(b,a){return b.createTextNode(a)},jD=function(d,ad,k,b,ac){for(var w="",p=ac.split("/"),g=iS,aa=f8,c=ad,y,ae=0,ab=p.length;ae<ab;ae++){w=p[ae],w.charAt(0)==="@"&&(w=w.substring(1),g=aC,aa=hA),y=g(c,k,w),y||(y=aa(d,k,Y(b,w)),jr(c,y)),c=y}return c},kM=function(b){var a=i8.XMLSerializer,c;if(a){return c=new a,c.serializeToString(b)}if(b.xml){return b.xml}throw {message:"XML serialization unsupported"}},e5=function(l){var g=l.childNodes,c,d=g.length,b;if(d===0){return""}var h=l.ownerDocument,k=h.createDocumentFragment(),a=h.createElement("c");for(k.appendChild(a),c=0;c<d;c++){a.appendChild(g[c])}for(b=kM(k),b=b.substr(3,b.length-7),c=0;c<d;c++){l.appendChild(a.childNodes[c])}return b},G=function(b){var c=b.xml,a;if(c!==iX){return c}if(i8.XMLSerializer){return a=new i8.XMLSerializer,a.serializeToString(b)}throw {message:"XML serialization unsupported"}},ix=function(c,b,a){return function(){return c[b].apply(c,arguments),a}},c5=function(){this._arguments=iX,this._done=iX,this._fail=iX,this._resolved=!1,this._rejected=!1};c5.prototype={then:function(b,a){return b&&(this._done?this._done.push(b):this._done=[b]),a&&(this._fail?this._fail.push(a):this._fail=[a]),this._resolved?this.resolve.apply(this,this._arguments):this._rejected&&this.reject.apply(this,this._arguments),this},resolve:function(){if(this._done){for(var b=0,a=this._done.length;b<a;b++){this._done[b].apply(null,arguments)}this._done=iX,this._resolved=!1,this._arguments=iX}else{this._resolved=!0,this._arguments=arguments}},reject:function(){if(this._fail){for(var b=0,a=this._fail.length;b<a;b++){this._fail[b].apply(null,arguments)}this._fail=iX,this._rejected=!1,this._arguments=iX}else{this._rejected=!0,this._arguments=arguments}},promise:function(){var a={};return a.then=ix(this,"then",a),a}};var bS=function(){return i8.jQuery&&i8.jQuery.Deferred?new i8.jQuery.Deferred:new c5},hO=function(c,b){var a=(c&&c.__metadata||{}).type;return a||(b?b.type:null)},jv="Edm.",dG=jv+"Binary",bU=jv+"Boolean",f7=jv+"Byte",f5=jv+"DateTime",iU=jv+"DateTimeOffset",iY=jv+"Decimal",eI=jv+"Double",jW=jv+"Guid",Z=jv+"Int16",kC=jv+"Int32",cX=jv+"Int64",B=jv+"SByte",jB=jv+"Single",i0=jv+"String",eG=jv+"Time",dF=jv+"Geography",e3=dF+"Point",im=dF+"LineString",gN=dF+"Polygon",ej=dF+"Collection",bH=dF+"MultiPolygon",fU=dF+"MultiLineString",cI=dF+"MultiPoint",g7=jv+"Geometry",a1=g7+"Point",hB=g7+"LineString",hY=g7+"Polygon",dP=g7+"Collection",b2=g7+"MultiPolygon",gA=g7+"MultiLineString",jf=g7+"MultiPoint",c9="Point",M="LineString",jL="Polygon",fx="MultiPoint",iG="MultiLineString",gX="MultiPolygon",ex="GeometryCollection",gP=[i0,kC,cX,bU,eI,jB,f5,iU,eG,iY,jW,f7,Z,B,dG],dY=[g7,a1,hB,hY,dP,b2,gA,jf],bj=[dF,e3,im,gN,ej,bH,fU,cI],eJ=function(e,c){if(!e){return null}if(jo(e)){for(var d,b=0,a=e.length;b<a;b++){if(d=eJ(e[b],c),d){return d}}return null}return e.dataServices?eJ(e.dataServices.schema,c):c(e)},eQ=function(b,a){return b=b===0?"":"."+ja(b.toString(),3),a>0&&(b===""&&(b=".000"),b+=ja(a.toString(),4)),b},j4=function(c){var p,v,l;if(typeof c=="string"){return c}if(p=g4(c),v=kK(c.__offset),p&&v!=="Z"){c=new Date(c.valueOf());var d=a6(v),b=c.getUTCHours()+d.d*d.h,w=c.getMinutes()+d.d*d.m;c.setUTCHours(b,w)}else{p||(v="")}var a=c.getUTCFullYear(),g=c.getUTCMonth()+1,k="";return a<=0&&(a=-(a-1),k="-"),l=eQ(c.getUTCMilliseconds(),c.__ns),k+ja(a,4)+"-"+ja(g,2)+"-"+ja(c.getUTCDate(),2)+"T"+ja(c.getUTCHours(),2)+":"+ja(c.getUTCMinutes(),2)+":"+ja(c.getUTCSeconds(),2)+l+v},aD=function(k){var c=k.ms,h="",b,d,a,g;return c<0&&(h="-",c=-c),b=Math.floor(c/86400000),c-=86400000*b,d=Math.floor(c/3600000),c-=3600000*d,a=Math.floor(c/60000),c-=60000*a,g=Math.floor(c/1000),c-=g*1000,h+"P"+ja(b,2)+"DT"+ja(d,2)+"H"+ja(a,2)+"M"+ja(g,2)+eQ(c,k.ns)+"S"},ja=function(d,b,a){for(var c=d.toString(10);c.length<b;){a?c+="0":c="0"+c}return c},kK=function(a){return !a||a==="Z"||a==="+00:00"||a==="-00:00"?"Z":a},jU=function(b){if(typeof b=="string"){var a=b.indexOf(")",10);if(b.indexOf("Collection(")===0&&a>0){return b.substring(11,a)}}return null},fH=function(h,b,c,a,d,g){return d.request(h,function(e){try{e.headers&&hE(e.headers),e.data===iX&&e.statusCode!==204&&a.read(e,g)}catch(i){i.request===iX&&(i.request=h),i.response===iX&&(i.response=e),c(i);return}b(e.data,e)},c)},cm=function(a){return jc(a)&&jo(a.__batchRequests)},aO=/Collection\((.*)\)/,c7=function(c,b){var a=c&&c.results||c;return !!a&&X(b)||!b&&jo(a)&&!jc(a[0])},X=function(a){return aO.test(a)},jc=function(a){return !!a&&jj(a)&&!jo(a)&&!gC(a)},g4=function(a){return a.__edmType==="Edm.DateTimeOffset"||!a.__edmType&&a.__offset},K=function(c){if(!c&&!jc(c)){return !1}var b=c.__metadata||{},a=c.__deferred||{};return !b.type&&!!a.uri},jJ=function(a){return jc(a)&&a.__metadata&&"uri" in a.__metadata},jX=function(c,b){var a=c&&c.results||c;return jo(a)&&!X(b)&&jc(a[0])},bK=function(a){return aU(bj,a)},fW=function(a){return aU(dY,a)},fm=function(c){if(!c&&!jc(c)){return !1}var b=c.__metadata,a=c.__mediaresource;return !b&&!!a&&!!a.media_src},kA=function(a){return gC(a)||typeof a=="string"||typeof a=="number"||typeof a=="boolean"},cL=function(a){return aU(gP,a)},iE=function(b,a){return K(b)?"deferred":jJ(b)?"entry":jX(b)?"feed":a&&a.relationship?b===null||b===iX||!jX(b)?"entry":"feed":null},J=function(b,a){return g9(b,function(c){return c.name===a})},a4=function(c,b,a){return c?eJ(b,function(d){return f3(c,d,a)}):null},hK=function(b,a){return g9(b,function(c){return c.name===a})},jI=function(b,a){return a4(b,a,"complexType")},fj=function(b,a){return a4(b,a,"entityType")},gV=function(a){return eJ(a,function(b){return g9(b.entityContainer,function(c){return h1(c.isDefaultEntityContainer)})})},eA=function(b,a){return a4(b,a,"entityContainer")},dB=function(b,a){return g9(b,function(c){return c.name===a})},bQ=function(g,c){var a=null,e,b,d;return g&&(e=g.relationship,b=eJ(c,function(o){var l=bM(o.namespace,e),k=o.association,h,f;if(l&&k){for(h=0,f=k.length;h<f;h++){if(k[h].name===l){return k[h]}}}}),b&&(d=b.end[0],d.role!==g.toRole&&(d=b.end[1]),a=d.type)),a},bM=function(b,a){return a.indexOf(b)===0&&a.charAt(b.length)==="."?a.substr(b.length+1):null},f3=function(d,b,a){if(d&&b){var c=bM(b.namespace,d);if(c){return g9(b[a],function(e){return e.name===c})}}return null},bT=function(l,c){var b,g,h;if(l===c){return l}var d=l.split("."),a=c.split("."),k=d.length>=a.length?d.length:a.length;for(b=0;b<k;b++){if(g=d[b]&&iZ(d[b]),h=a[b]&&iZ(a[b]),g>h){return l}if(g<h){return c}}},iQ={accept:"Accept","content-type":"Content-Type",dataserviceversion:"DataServiceVersion",maxdataserviceversion:"MaxDataServiceVersion"},hE=function(e){var c,d,b,a;for(c in e){d=c.toLowerCase(),b=iQ[d],b&&c!==b&&(a=e[c],delete e[c],e[b]=a)}},h1=function(a){return typeof a=="boolean"?a:typeof a=="string"&&a.toLowerCase()==="true"},eE=/^(-?\d{4,})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(.*)$/,fZ=function(k,ag,l){var b=eE.exec(k),g=b?kK(b[8]):null,s,af,aa,ab,ad,w;if(!b||!ag&&g!=="Z"){if(l){return null}throw {message:"Invalid date/time value"}}if(s=iZ(b[1]),s<=0&&s++,af=b[7],aa=0,af){if(af.length>7){if(l){return null}throw {message:"Cannot parse date/time value to given precision."}}aa=ja(af.substring(3),4,!0),af=ja(af.substring(0,3),3,!0),af=iZ(af),aa=iZ(aa)}else{af=0}var ae=iZ(b[4]),ac=iZ(b[5]),d=iZ(b[6]);if(g!=="Z"&&(ab=a6(g),ad=-ab.d,ae+=ab.h*ad,ac+=ab.m*ad),w=new Date,w.setUTCFullYear(s,iZ(b[2])-1,iZ(b[3])),w.setUTCHours(ae,ac,d,af),isNaN(w.valueOf())){if(l){return null}throw {message:"Invalid date/time value"}}return ag&&(w.__edmType="Edm.DateTimeOffset",w.__offset=g),aa&&(w.__ns=aa),w},cV=function(b,a){return fZ(b,!1,a)},dS=function(b,a){return fZ(b,!0,a)},cN=/^([+-])?P(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)(?:\.(\d+))?S)?)?/,hQ=function(a){cN.test(a)},b5=function(g){var k=cN.exec(g),aa,b,y;if(k===null){throw {message:"Invalid duration value."}}var p=k[2]||"0",s=k[3]||"0",d=iZ(k[4]||0),l=iZ(k[5]||0),v=iZ(k[6]||0),w=parseFloat(k[7]||0);if(p!=="0"||s!=="0"){throw {message:"Unsupported duration value."}}if(aa=k[8],b=0,aa){if(aa.length>7){throw {message:"Cannot parse duration value to given precision."}}b=ja(aa.substring(3),4,!0),aa=ja(aa.substring(0,3),3,!0),aa=iZ(aa),b=iZ(b)}else{aa=0}return aa+=w*1000+v*60000+l*3600000+d*86400000,k[1]==="-"&&(aa=-aa),y={ms:aa,__edmType:"Edm.Time"},b&&(y.ns=b),y},a6=function(d){var b=d.substring(0,1),a,c;return b=b==="+"?1:-1,a=iZ(d.substring(1)),c=iZ(d.substring(d.indexOf(":")+1)),{d:b,h:a,m:c}},hG=function(c,a,b){c.method||(c.method="GET"),c.headers?hE(c.headers):c.headers={},c.headers.Accept===iX&&(c.headers.Accept=a.accept),jV(c.data)&&c.body===iX&&a.write(c,b),jV(c.headers.MaxDataServiceVersion)||(c.headers.MaxDataServiceVersion=a.maxDataServiceVersion||"1.0")},h3=function(h,b,c){var a,g,d;if(h&&typeof h=="object"){for(a in h){g=h[a],d=h3(g,a,c),d=c(a,d,b),d!==g&&(g===iX?delete h[a]:h[a]=d)}}return h},jS=function(b,a){return a("",h3(b,"",a))},z=0,V=function(a){return a.method&&a.method!=="GET"?!1:!0},kx=function(c){var b=i8.document.createElement("IFRAME");b.style.display="none";var d=c.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/\</g,"&lt;"),a='<html><head><script type="text/javascript" src="'+d+'"><\/script></head><body></body></html>',e=i8.document.getElementsByTagName("BODY")[0];return e.appendChild(b),dU(b,a),b},cT=function(){if(i8.XMLHttpRequest){return new i8.XMLHttpRequest}var b;if(i8.ActiveXObject){try{return new i8.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){try{return new i8.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(c){b=c}}}else{b={message:"XMLHttpRequest not supported"}}throw b},q=function(a){return a.indexOf("http://")===0||a.indexOf("https://")===0||a.indexOf("file://")===0},jx=function(b){if(!q(b)){return !0}var a=i8.location,c=a.protocol+"//"+a.host+"/";return b.indexOf(c)===0},eZ=function(b,c){try{delete i8[b]}catch(a){i8[b]=iX,c===z-1&&(z-=1)}},gD=function(a){return a&&(dU(a,""),a.parentNode.removeChild(a)),null},h7=function(g,c){for(var d=g.getAllResponseHeaders().split(/\r?\n/),a,b=0,e=d.length;b<e;b++){d[b]&&(a=d[b].split(": "),c[a[0]]=a[1])}},dU=function(c,b){var a=c.contentWindow?c.contentWindow.document:c.contentDocument.document;a.open(),a.write(b),a.close()};i1.defaultHttpClient={callbackParameterName:"$callback",formatQueryString:"$format=json",enableJsonpCallback:!1,request:function(ad,ak,af){var ab={},ac=null,ap=!1,ae,ah,ag,aa,au,ai,at,av;ab.abort=function(){(ae=gD(ae),ap)||(ap=!0,ac&&(ac.abort(),ac=null),af({message:"Request aborted"}))};var o=function(){ae=gD(ae),ap||(ap=!0,ac=null,af({message:"Request timed out"}))},al,ao=ad.requestUri,ar=d1(ad.enableJsonpCallback,this.enableJsonpCallback),an=d1(ad.callbackParameterName,this.callbackParameterName),n=d1(ad.formatQueryString,this.formatQueryString);if(!ar||jx(ao)){if(ac=cT(),ac.onreadystatechange=function(){var c,d,b,a;ap||ac===null||ac.readyState!==4||(c=ac.statusText,d=ac.status,d===1223&&(d=204,c="No Content"),b=[],h7(ac,b),a={requestUri:ao,statusCode:d,statusText:c,headers:b,body:ac.responseText},ap=!0,ac=null,d>=200&&d<=299?ak(a):af({message:"HTTP request failed",request:ad,response:a}))},ac.open(ad.method||"GET",ao,!0,ad.user,ad.password),ad.headers){for(al in ad.headers){ac.setRequestHeader(al,ad.headers[al])}}ad.timeoutMS&&(ac.timeout=ad.timeoutMS,ac.ontimeout=o),ac.send(ad.body)}else{if(!V(ad)){throw {message:"Request is not local and cannot be done through JSONP."}}ah=z,z+=1,ag=ah.toString(),aa=!1,al="handleJSONP_"+ag,i8[al]=function(a){ae=gD(ae),ap||(aa=!0,i8.clearTimeout(au),eZ(al,ah),i8.ActiveXObject&&!i8.DOMParser&&(a=i8.JSON.parse(i8.JSON.stringify(a))),i7(ak,{body:a,statusCode:200,headers:{"Content-Type":"application/json"}}))},ai=ad.timeoutMS?ad.timeoutMS:120000,au=i8.setTimeout(o,ai),at=an+"=parent."+al,this.formatQueryString&&(at+="&"+n),av=ao.indexOf("?"),ao=av===-1?ao+"?"+at:av===ao.length-1?ao+at:ao+"&"+at,ae=kx(ao)}return ab}};var hW="3.0",iD=function(g){var c,d,b,e,a;if(!g){return null}for(c=g.split(";"),d={},b=1,e=c.length;b<e;b++){a=c[b].split("="),d[E(a[0])]=a[1]}return{mediaType:E(c[0]),properties:d}},gJ=function(c){if(!c){return iX}var b=c.mediaType,a;for(a in c.properties){b+=";"+a+"="+c.properties[a]}return b},b7=function(e,c,b,d){var a={contentType:e,dataServiceVersion:c,handler:d};return bx(a,b)},gF=function(d,b,a){if(d){var c=d.headers;c[b]||(c[b]=a)}},eB=function(d,b){if(d){var a=d.headers,c=a.DataServiceVersion;a.DataServiceVersion=c?bT(c,b):b}},jq=function(c,a){var b=c.headers;return b&&b[a]||iX},eV=function(a){return iD(jq(a,"Content-Type"))},bN=/^\s?(\d+\.\d+);?.*$/,j9=function(c){var b=jq(c,"DataServiceVersion"),a;if(b&&(a=bN.exec(b),a&&a.length)){return a[1]}},aJ=function(b,a){return b.accept.indexOf(a.mediaType)>=0},f0=function(l,b,d,a){var g;if(!d||!d.headers){return !1}var h=eV(d),c=j9(d)||"",k=d.body;return jV(k)?aJ(l,h)?(g=b7(h,c,a,l),g.response=d,d.data=b(l,k,g),d.data!==iX):!1:!1},cP=function(k,b,c,a){var g,h,d;return !c||!c.headers?!1:(g=eV(c),h=j9(c),(!g||aJ(k,g))&&(d=b7(g,h,a,k),d.request=c,c.body=b(k,c.data,d),c.body!==iX))?(eB(c,d.dataServiceVersion||"1.0"),gF(c,"Content-Type",gJ(d.contentType)),gF(c,"MaxDataServiceVersion",k.maxDataServiceVersion),!0):!1},dO=function(d,b,a,c){return{accept:a,maxDataServiceVersion:c,read:function(f,e){return f0(this,d,f,e)},write:function(f,e){return cP(this,b,f,e)}}},a7=function(b,a){return a},hH=function(b,a){return jV(a)?a.toString():iX};i1.textHandler=dO(a7,hH,"text/plain",hW);var kP=aQ+"www.opengis.net",cz=kP+"/gml",dq=kP+"/def/crs/EPSG/0/",Q="gml",aj=function(d,b,a){var c={type:d};return c[b]=a,c},jm=function(b){if(jo(b)&&b.length>=2){var a=b[0];b[0]=b[1],b[1]=a}return b},eT=function(k,c,b,d,a,g){var h=jO(k,b,d,a,g);return aj(c,"coordinates",h)},jO=function(g,b,a,c,d){var f=[];return iO(g,function(l){var i,e,k;if(iV(l)===cz){if(i=jl(l),i===b){e=iS(l,cz),e&&(k=c(e,d),k&&f.push(k));return}i===a&&iO(l,function(o){if(iV(o)===cz){var h=c(o,d);h&&f.push(h)}})}}),f},h4=function(c,b){var a=jO(c,"geometryMember","geometryMembers",g0,b);return aj(ex,"geometries",a)},dV=function(b,a){return aj(M,"coordinates",j7(b,a))},b8=function(b,a){return eT(b,iG,"curveMember","curveMembers",j7,a)},gG=function(b,a){return eT(b,fx,"pointMember","pointMembers",aH,a)},js=function(b,a){return eT(b,gX,"surfaceMember","surfaceMembers",fB,a)},eW=function(b,a){return aj(c9,"coordinates",aH(b,a))},km=function(b,a){return aj(jL,"coordinates",fB(b,a))},j7=function(c,b){var a=[];return iO(c,function(g){var f=iV(g),d;if(f===cz){if(d=jl(g),d==="posList"){a=kQ(g,b);return}if(d==="pointProperty"){a.push(aK(g,b));return}if(d==="pos"){a.push(kN(g,b));return}}}),a},aH=function(c,b){var a=iS(c,cz,"pos");return a?kN(a,b):[]},aK=function(c,b){var a=iS(c,cz,"Point");return a?aH(a,b):[]},fB=function(d,b){var a=[],c=!1;return iO(d,function(g){if(iV(g)===cz){var f=jl(g);if(f==="exterior"){c=!0,a.unshift(iJ(g,b));return}if(f==="interior"){a.push(iJ(g,b));return}}}),!c&&a.length>0&&a.unshift([[]]),a},iJ=function(c,b){var a=[];return iO(c,function(d){iV(d)===cz&&jl(d)==="LinearRing"&&(a=j7(d,b))}),a},kQ=function(k,c){var g=kN(k,!1),h=g.length,d,b,a;if(h%2!=0){throw {message:"GML posList element has an uneven number of numeric values"}}for(d=[],b=0;b<h;b+=2){a=g.slice(b,b+2),d.push(c?jm(a):a)}return d},kN=function(c,l){var k=[],b=" \t\r\n",a=ju(c),g;if(a){for(var p=a.length,h=0,d=0;d<=p;){b.indexOf(a.charAt(d))!==-1&&(g=a.substring(h,d),g&&k.push(parseFloat(g)),h=d+1),d++}}return l?jm(k):k},g0=function(h,c){var g=jl(h),b,a,d,f;switch(g){case"Point":b=eW;break;case"Polygon":b=km;break;case"LineString":b=dV;break;case"MultiPoint":b=gG;break;case"MultiCurve":b=b8;break;case"MultiSurface":b=js;break;case"MultiGeometry":b=h4;break;default:throw {message:"Unsupported element: "+g,element:h}}if(a=b(h,c),d=hN(h,"srsName",cz)||hN(h,"srsName"),d){if(d.indexOf(dq)!==0){throw {message:"Unsupported srs name: "+d,element:h}}f=d.substring(dq.length),f&&(a.crs={type:"name",properties:{name:"EPSG:"+f}})}return a},d7=function(c,y,g,a){var w,b,v,aa,p,k,d;switch(g){case c9:w=dx;break;case M:w=R;break;case jL:w=jP;break;case fx:w=fC;break;case iG:w=iK;break;case gX:w=g1;break;case ex:w=bF;break;default:return null}return b=w(c,y,a),v=y.crs,v&&v.type==="name"&&(aa=v.properties,p=aa&&aa.name,p&&p.indexOf("ESPG:")===0&&p.length>5&&(k=p.substring(5),d=hA(c,null,"srsName",Q+k),jr(b,d))),b},kB=function(c,b,a){return f8(c,cz,Y(Q,b),a)},bE=function(d,b,a){var c=jo(b)?b:[];return c=a?jm(c):c,kB(d,"pos",c.join(" "))},fR=function(h,c,b,d){var e=kB(h,c),a,g;if(jo(b)){for(a=0,g=b.length;a<g;a++){jr(e,bE(h,b[a],d))}g===0&&jr(e,kB(h,"posList"))}return e},cF=function(c,b,a){return kB(c,"Point",bE(c,b,a))},aY=function(c,b,a){return fR(c,"LineString",b,a)},hx=function(g,c,b,d){var a=kB(g,c),e;return jo(b)&&b.length>0&&(e=fR(g,"LinearRing",b,d),jr(a,e)),a},hU=function(g,c,b){var e=c&&c.length,a=kB(g,"Polygon"),d;if(jo(c)&&e>0){for(jr(a,hx(g,"exterior",c[0],b)),d=1;d<e;d++){jr(a,hx(g,"interior",c[d],b))}}return a},dx=function(c,b,a){return cF(c,b.coordinates,a)},R=function(c,b,a){return aY(c,b.coordinates,a)},jP=function(c,b,a){return hU(c,b.coordinates,a)},jz=function(c,v,e,a,p,k){var g=a&&a.length,d=kB(c,v),w,b;if(jo(a)&&g>0){for(w=kB(c,e),b=0;b<g;b++){jr(w,p(c,a[b],k))}jr(d,w)}return d},fC=function(c,b,a){return jz(c,"MultiPoint","pointMembers",b.coordinates,cF,a)},iK=function(c,b,a){return jz(c,"MultiCurve","curveMembers",b.coordinates,aY,a)},g1=function(c,b,a){return jz(c,"MultiSurface","surfaceMembers",b.coordinates,hU,a)},d8=function(c,b,a){return d7(c,b,b.type,a)},bF=function(c,b,a){return jz(c,"MultiGeometry","geometryMembers",b.geometries,d8,a)},e1="application/xml",cW=aQ+"schemas.microsoft.com/ado/",b1=cW+"2007/08/dataservices",h9=cW+"2007/06/edmx",fS=cW+"2006/04/edm",cG=cW+"2007/05/edm",aZ=cW+"2008/01/edm",hz=cW+"2008/09/edm",hV=cW+"2009/08/edm",dN=cW+"2009/11/edm",f6=b1,jp=b1+"/metadata",dj=b1+"/related/",dM=b1+"/scheme",bZ="d",N="m",A=function(c,b){var a={name:jl(c),value:c.value};return a[b?"namespaceURI":"namespace"]=iV(c),a},kD=function(d,v){for(var w=[],k=[],u=d.attributes,p,g,b,a=0,f=u.length;a<f;a++){p=u[a],iV(p)!==dH&&w.push(A(p,v))}for(g=d.firstChild;g!=null;){g.nodeType===1&&k.push(kD(g,v)),g=g.nextSibling}return b={name:jl(d),value:ju(d),attributes:w,children:k},b[v?"namespaceURI":"namespace"]=iV(d),b},jM=function(a){return iV(a)===f6&&jl(a)==="element"},gq=function(b,a){return{type:b,extensions:a}},b0=function(c){var b,a;return iS(c,cz)?g7:(b=iS(c,f6),!b)?i0:jM(b)&&(a=kE(b,f6),a&&jM(a))?"Collection()":null},i9=function(d){var b=null,a=!1,c=[];return j3(d,function(i){var g=iV(i),h=jl(i),f=kJ(i);if(g===jp){if(h==="null"){a=f.toLowerCase()==="true";return}if(h==="type"){b=f;return}}if(g!==eP&&g!==dH){c.push(A(i,!0));return}}),{type:!b&&a?i0:b,isNull:a,extensions:c}},eN=function(h){if(iV(h)!==f6){return null}var f=jl(h),b=i9(h),g=b.isNull,a=b.type,d=gq(a,b.extensions),c=g?null:j1(h,a,d);return{name:f,value:c,metadata:d}},j1=function(d,b,a){b||(b=b0(d),a.type=b);var c=bK(b);return c||fW(b)?gx(d,b,c):cL(b)?aA(d,b):X(b)?eO(d,b,a):jb(d,b,a)},gx=function(e,c,b){var a=iS(e,cz),d=g0(a,b);return d.__metadata={type:c},d},aA=function(c,b){var a=kJ(c)||"";switch(b){case bU:return h1(a);case dG:case iY:case jW:case cX:case i0:return a;case f7:case Z:case kC:case B:return iZ(a);case eI:case jB:return parseFloat(a);case eG:return b5(a);case f5:return cV(a);case iU:return dS(a)}return a},jb=function(d,b,a){var c={__metadata:{type:b}};return iO(d,function(g){var f=eN(g),e=f.name;a.properties=a.properties||{},a.properties[e]=f.metadata,c[e]=f.value}),c},eO=function(g,c,b){var d=[],a=b.elements=[],e=jU(c);return iO(g,function(r){if(jM(r)){var h=i9(r),p=h.extensions,f=h.type||e,l=gq(f,p),k=j1(r,f,l);d.push(k),a.push(l)}}),{__metadata:{type:c==="Collection()"?null:c},results:d}},j2=function(c,a){if(iV(c)===f6){a=fL(c,a);var b=jl(c);if(b==="links"){return aB(c,a)}if(b==="uri"){return kH(c,a)}}return iX},aB=function(c,b){var a=[];return iO(c,function(d){jl(d)==="uri"&&iV(d)===f6&&a.push(kH(d,b))}),{results:a}},kH=function(c,b){var a=ju(c)||"";return{uri:jh(a,b)}},kI=function(b,a){return a===g7||a===dF?b&&b.type:a===a1||a===e3?c9:a===hB||a===im?M:a===hY||a===gN?jL:a===dP||a===ej?ex:a===b2||a===bH?gX:a===gA||a===fU?iG:a===jf||a===cI?fx:null},c3=function(c,b,a){return f8(c,jp,Y(N,b),a)},fz=function(c,b,a){return hA(c,jp,Y(N,b),a)},H=function(c,b,a){return f8(c,f6,Y(bZ,b),a)},c4=function(b,a){return a===f5||a===iU||gC(b)?j4(b):a===eG?aD(b):b.toString()},iW=function(b,a){return{element:b,dsv:a}},cY=function(g,c,b,d){var a=b?fz(g,"type",b):null,e=H(g,c,a);return dE(e,d)},I=function(g,c,b,d){var a=c4(b,d),e=cY(g,c,d,a);return iW(e,"1.0")},jH=function(k,c,b,d){var a=fz(k,"null","true"),g=cY(k,c,b,a),h=jI(b,d)?"2.0":"1.0";return iW(g,h)},e9=function(e,ah,k,b,ag,ab,d){var g=jU(b),ad=jo(k)?k:k.results,af=b?{type:g}:{},aa,ai,ac,c,ae;for(af.properties=ag.properties,aa=cY(e,ah,g?b:null),ai=0,ac=ad.length;ai<ac;ai++){c=ad[ai],ae=iH(e,"element",c,af,ab,d),jr(aa,ae.element)}return iW(aa,"3.0")},iB=function(g,ak,aa,b,ai,ac,ad){var ab=cY(g,ak,b),af=ai.properties||{},ah=jI(b,ad)||{},al="1.0",d;for(d in aa){if(d!=="__metadata"){var ae=aa[d],c=J(ah.property,d),ag=af[d]||{},k=iH(g,d,ae,ag,c,ad);al=bT(al,k.dsv),jr(ab,k.element)}}return iW(ab,al)},gT=function(l,c,b,d,a){var g=kI(b,d),h=d7(l,b,g,a),k=cY(l,c,d,h);return iW(k,"3.0")},iH=function(c,l,d,a,k,g){var h=hO(d,a,k),b,p;return kA(d)?I(c,l,d,h||i0):(b=bK(h),b||fW(h))?gT(c,l,d,h,b):c7(d,h)?e9(c,l,d,h,a,k,g):fm(d)?null:(p=iE(d,k),p!==null)?null:d===null?jH(c,l,h):iB(c,l,d,h,a,k,g)},ez=function(b){if(b&&jj(b)){var a=aT();return jr(a,H(a,"uri",b.uri))}},bL=function(d,b){if(b){var c=hM(b),a=iS(c);if(a){return j2(a)}}},fY=function(d,b,c){var a=c.contentType=c.contentType||iD(e1);return a&&a.mediaType===e1?kM(ez(b)):iX};i1.xmlHandler=dO(bL,fY,e1,hW);var jG="a",jA=hP+"2005/Atom",C=hP+"2007/app",e8=b1+"/edit-media/",iA=b1+"/mediaresource/",gS=b1+"/relatedlinks/",eC=["application/atom+xml","application/atomsvc+xml","application/xml"],bO=eC[0],cM=[jA,C,eP,dH],a5={SyndicationAuthorEmail:"author/email",SyndicationAuthorName:"author/name",SyndicationAuthorUri:"author/uri",SyndicationContributorEmail:"contributor/email",SyndicationContributorName:"contributor/name",SyndicationContributorUri:"contributor/uri",SyndicationPublished:"published",SyndicationRights:"rights",SyndicationSummary:"summary",SyndicationTitle:"title",SyndicationUpdated:"updated"},hF=function(a){return a5[a]||a},jC=function(a){return !aU(cM,a)},f1=function(g,ad,p,b,ac){var w;if(ac=ac||"",w=g["FC_TargetPath"+ac],!w){return null}var y=g["FC_SourcePath"+ac],ae=hF(w),d=b?b+(y?"/"+y:""):y,k=d&&eU(p,ad,d),v=g["FC_NsUri"+ac]||null,aa=g["FC_NsPrefix"+ac]||null,ab=g["FC_KeepInContent"+ac]||"";return w!==ae&&(v=jA,aa=jG),{contentKind:g["FC_ContentKind"+ac],keepInContent:ab.toLowerCase()==="true",nsPrefix:aa,nsURI:v,propertyPath:d,propertyType:k,entryPath:ae}},cQ=function(d,ab,k){for(var y=[],g,a,v,aa,w;d;){for(g=d.FC_SourcePath,a=f1(d,d,ab),a&&k(a),v=d.property||[],aa=0,w=v.length;aa<w;aa++){for(var b=v[aa],ac=0,p="";a=f1(b,d,ab,b.name,p);){k(a),ac++,p="_"+ac}}d=fj(d.baseType,ab)}return y},gL=function(b){var a=[];return j3(b,function(d){var c=iV(d);jC(c)&&a.push(A(d,!0))}),a},a8=function(a){return kD(a,!0)},hI=function(f,b,a){var d=iV(f),c=jl(f);if(d===C&&c==="service"){return gZ(f,b)}if(d===jA){if(c==="feed"){return h2(f,b,a)}if(c==="entry"){return jt(f,b,a)}}},h5=function(d,b){var c=[],a={extensions:c};return j3(d,function(g){var h=jl(g),f=iV(g),i=kJ(g);if(f===null){if(h==="title"||h==="metadata"){a[h]=i;return}if(h==="target"){a.target=jh(i,fL(d,b));return}}jC(f)&&c.push(A(g,!0))}),a},dW=function(d,b,a){var c=a.actions=a.actions||[];c.push(h5(d,b))},b9=function(d,b,a){var c=a.functions=a.functions||[];c.push(h5(d,b))},h2=function(h,b,a){var g=gL(h),d={feed_extensions:g},c=[],f={__metadata:d,results:c};return b=fL(h,b),iO(h,function(k){var e=iV(k),i=jl(k);if(e===jp){if(i==="count"){f.__count=parseInt(ju(k));return}if(i==="action"){dW(k,b,d);return}if(i==="function"){b9(k,b,d);return}}if(jC(e)){g.push(kD(k));return}if(i==="entry"){c.push(jt(k,b,a));return}if(i==="link"){dT(k,f,b);return}if(i==="id"){d.uri=jh(ju(k),b),d.uri_extensions=gL(k);return}if(i==="title"){d.title=ju(k)||"",d.title_extensions=gL(k);return}}),f},dT=function(l,c,b){var d=gH(l,b),g=d.href,h=d.rel,k=d.extensions,a=c.__metadata;if(h==="next"){c.__next=g,a.next_extensions=k;return}if(h==="self"){a.self=g,a.self_extensions=k;return}},gH=function(d,b){b=fL(d,b);var c=[],a={extensions:c,baseURI:b};if(j3(d,function(i){var f=iV(i),g=jl(i),h=i.value;if(g==="href"){a.href=jh(h,b);return}if(g==="type"||g==="rel"){a[g]=h;return}jC(f)&&c.push(A(i,!0))}),!a.href){throw {error:"href attribute missing on link element",element:d}}return a},b6=function(e,b){if(e.indexOf("/")===-1){return b[e]}for(var a=e.split("/"),c=0,d=a.length;c<d;c++){if(b===null){return iX}if(b=b[a[c]],b===iX){return b}}return b},gE=function(g,p,b,ab){var d,ac,v,t,w;if(g.indexOf("/")===-1){p[g]=b,d=g}else{for(ac=g.split("/"),v=0,t=ac.length-1;v<t;v++){if(w=p[ac[v]],w===iX){w={},p[ac[v]]=w}else{if(w===null){return}}p=w}d=ac[v],p[d]=b}if(ab){var y=p.__metadata=p.__metadata||{},k=y.properties=y.properties||{},aa=k[d]=k[d]||{};aa.type=ab}},jn=function(k,c,b){var h=k.propertyPath,d,a,g;k.keepInContent||b6(h,b)===null||(d=jY(c,k.nsURI,k.entryPath),d)&&(a=k.propertyType,g=k.contentKind==="xhtml"?e5(d):aA(d,a||"Edm.String"),gE(h,b,g,a))},eU=function(c,v,d){for(var w=d.split("/"),p,g,k,l,b,a;v;){for(k=v,p=0,g=w.length;p<g;p++){if(l=k.property,!l){break}if(b=J(l,w[p]),!b){break}if(a=b.type,!a||cL(a)){return a||null}if(k=jI(a,c),!k){return null}}v=fj(v.baseType,c)}return null},jt=function(h,b,a){var d={},f={__metadata:d},g=hN(h,"etag",jp),c;return g&&(d.etag=g),b=fL(h,b),iO(h,function(k){var e=iV(k),i=jl(k);if(e===jA){if(i==="id"){j8(k,d,b);return}if(i==="category"){aI(k,d);return}if(i==="content"){kO(k,f,d,b);return}if(i==="link"){dm(k,f,d,b,a);return}return}if(e===jp){if(i==="properties"){aL(k,f,d);return}if(i==="action"){dW(k,b,d);return}if(i==="function"){b9(k,b,d);return}}}),c=fj(d.type,a),cQ(c,a,function(e){jn(e,h,f)}),f},j8=function(c,b,a){b.uri=jh(ju(c),fL(c,a)),b.uri_extensions=gL(c)},aI=function(c,b){if(hN(c,"scheme")===dM){if(b.type){throw {message:"Invalid AtomPub document: multiple category elements defining the entry type were encounterd withing an entry",element:c}}var a=[];j3(c,function(f){var d=iV(f),e=jl(f);if(!d){e!=="scheme"&&e!=="term"&&a.push(A(f,!0));return}jC(d)&&a.push(A(f,!0))}),b.type=hN(c,"term"),b.type_extensions=a}},kO=function(g,b,a,c){var d=hN(g,"src"),f=hN(g,"type");if(d){if(!f){throw {message:"Invalid AtomPub document: content element must specify the type attribute if the src attribute is also specified",element:g}}a.media_src=jh(d,fL(g,c)),a.content_type=f}iO(g,function(e){if(d){throw {message:"Invalid AtomPub document: content element must not have child elements if the src attribute is specified",element:g}}iV(e)===jp&&jl(e)==="properties"&&aL(e,b,a)})},dm=function(c,l,d,a,k){var g=gH(c,a),h=g.rel,p=g.href,b=g.extensions;if(h==="self"){d.self=p,d.self_link_extensions=b;return}if(h==="edit"){d.edit=p,d.edit_link_extensions=b;return}if(h==="edit-media"){d.edit_media=g.href,d.edit_media_extensions=b,kq(g,d);return}if(h.indexOf(e8)===0){fA(g,l,d);return}if(h.indexOf(iA)===0){iI(g,l,d);return}if(h.indexOf(dj)===0){jN(c,g,l,d,k);return}if(h.indexOf(gS)===0){O(g,d);return}},O=function(d,b){var c=d.rel.substring(gS.length),a;b.properties=b.properties||{},a=b.properties[c]=b.properties[c]||{},a.associationuri=d.href,a.associationuri_extensions=d.extensions},jN=function(d,y,g,a,w){var p,b=iS(d,jp,"inline"),aa,k,l,v;b?(aa=iS(b),k=fL(b,y.baseURI),p=aa?hI(aa,k,w):null):p={__deferred:{uri:y.href}},l=y.rel.substring(dj.length),g[l]=p,a.properties=a.properties||{},v=a.properties[l]=a.properties[l]||{},v.extensions=y.extensions},fA=function(l,c,b){var k=l.rel.substring(e8.length),g=eX(k,c,b),d=g.value,a=g.metadata,h=l.href;d.edit_media=h,d.content_type=l.type,a.edit_media_extensions=l.extensions,d.media_src=d.media_src||h,a.media_src_extensions=a.media_src_extensions||[],kq(l,d)},iI=function(k,c,b){var g=k.rel.substring(iA.length),d=eX(g,c,b),a=d.value,h=d.metadata;a.media_src=k.href,h.media_src_extensions=k.extensions,a.content_type=k.type},eX=function(e,c,b){b.properties=b.properties||{};var a=b.properties[e],d=c[e]&&c[e].__mediaresource;return d||(d={},c[e]={__mediaresource:d},b.properties[e]=a={}),{value:d,metadata:a}},kq=function(e,c){for(var d=e.extensions,b=0,a=d.length;b<a;b++){if(d[b].namespaceURI===jp&&d[b].name==="etag"){c.media_etag=d[b].value,d.splice(b,1);return}}},aL=function(c,b,a){iO(c,function(h){var e=eN(h),d,g;e&&(d=e.name,g=a.properties=a.properties||{},g[d]=e.metadata,b[d]=e.value)})},gZ=function(d,b){var a=[],c=[];if(b=fL(d,b),iO(d,function(e){if(iV(e)===C&&jl(e)==="workspace"){a.push(em(e,b));return}c.push(kD(e))}),a.length===0){throw {message:"Invalid AtomPub service document: No workspace element found.",element:d}}return{workspaces:a,extensions:c}},em=function(f,a){var c=[],d=[],b=iX;return a=fL(f,a),iO(f,function(i){var g=iV(i),e=jl(i);if(g===jA&&e==="title"){if(b!==iX){throw {message:"Invalid AtomPub service document: workspace has more than one child title element",element:i}}b=ju(i);return}if(g===C){e==="collection"&&c.push(bI(i,a));return}d.push(a8(i))}),{title:b||"",collections:c,extensions:d}},bI=function(f,a){var c=hN(f,"href"),d,b;if(!c){throw {message:"Invalid AtomPub service document: collection has no href attribute",element:f}}if(a=fL(f,a),c=jh(c,fL(f,a)),d=[],b=iX,iO(f,function(g){var k=iV(g),h=jl(g);if(k===jA){if(h==="title"){if(b!==iX){throw {message:"Invalid AtomPub service document: collection has more than one child title element",element:g}}b=ju(g)}return}k!==C&&d.push(a8(f))}),!b){throw {message:"Invalid AtomPub service document: collection has no title element",element:f}}return{title:b,href:c,extensions:d}},e2=function(c,b,a){return f8(c,jA,Y(jG,b),a)},gU=function(c,b,a){return hA(c,null,b,a)},fV=function(g){var b,d,a,f,c;if(g.childNodes.length>0){return !1}for(b=!0,d=g.attributes,a=0,f=d.length;a<f&&b;a++){c=d[a],b=b&&bW(c)||iV(c)==jp&&jl(c)==="type"}return b},cJ=function(c,v,g,a,p){var w=null,k=null,h=null,b="",d;return g!=="deferred"?(w=gU(c,"type","application/atom+xml;type="+g),k=c3(c,"inline"),a&&(b=a.__metadata&&a.__metadata.uri||"",h=kR(c,a,p)||gY(c,a,p),jr(k,h.element))):b=a.__deferred.uri,d=e2(c,"link",[gU(c,"href",b),gU(c,"rel",jh(v,dj)),w,k]),iW(d,h?h.dsv:"1.0")},a2=function(l,c,b,d,a,g){var h,k;return fm(b)?null:(h=iH(l,c,b,d,a,g),h||(k=iE(b,a),h=cJ(l,c,k,b,g)),h)},hC=function(d,ab,k,a){var aa=fM(k,f6,a.propertyPath),g=aa&&aC(aa,"null",jp),b,ac="1.0",v,w,p,y;if(g&&g.value==="true"){return ac}if(aa&&(b=ju(aa)||"",!a.keepInContent)){for(ac="2.0",v=aa.parentNode,w=v,v.removeChild(aa);w!==k&&fV(w);){v=w.parentNode,v.removeChild(w),w=v}}return(p=jD(d,ab,a.nsURI,a.nsPrefix,a.entryPath),p.nodeType===2)?(p.value=b,ac):(y=a.contentKind,dE(p,[y&&hA(d,null,"type",y),y==="xhtml"?c0(d,b):b]),ac)},gY=function(af,aa,ai){var an=aa.__metadata||{},ap=an.properties||{},c=an.etag,ad=an.uri,ab=an.type,ae=fj(ab,ai),ak=c3(af,"properties"),ag=e2(af,"entry",[e2(af,"author",e2(af,"name")),c&&fz(af,"etag",c),ad&&e2(af,"id",ad),ab&&e2(af,"category",[gU(af,"term",ab),gU(af,"scheme",dM)]),e2(af,"content",[gU(af,"type","application/xml"),ak])]),al="1.0",ac,u,g;for(ac in aa){if(ac!=="__metadata"){var ah=ap[ac]||{},ao=ae&&(J(ae.property,ac)||J(ae.navigationProperty,ac)),ar=a2(af,ac,aa[ac],ah,ao,ai);ar&&(u=ar.element,g=iV(u)===jA?ag:ak,jr(g,u),al=bT(al,ar.dsv))}}return cQ(ae,ai,function(b){var a=hC(af,ag,ak,b);al=bT(al,a)}),iW(ag,al)},kR=function(c,l,d){var g=jo(l)?l:l.results,a,b,k,e,p;if(!g){return null}for(a="1.0",b=e2(c,"feed"),k=0,e=g.length;k<e;k++){p=gY(c,g[k],d),jr(b,p.element),a=bT(a,p.dsv)}return iW(b,a)},hZ=function(g,c){var a,b,d,e;return g&&(a=jX(g)&&kR||jj(g)&&gY,a&&(b=aT(),d=a(b,g,c),d))?(e=d.element,dE(e,[g8(b,jp,N),g8(b,f6,bZ)]),iW(jr(b,e),d.dsv)):null},dQ=function(e,c,b){if(c){var a=hM(c),d=iS(a);if(d){return hI(d,null,b.metadata)}}},b3=function(e,c,b){var a=b.contentType=b.contentType||iD(bO),d;if(a&&a.mediaType===bO&&(d=hZ(c,b.metadata),d)){return b.dataServiceVersion=bT(b.dataServiceVersion||"1.0",d.dsv),kM(d.element)}};i1.atomHandler=dO(dQ,b3,eC.join(","),hW);var je=function(d,b,a,c){return{attributes:d,elements:b,text:a||!1,ns:c}},ji={elements:{Annotations:je(["Target","Qualifier"],["TypeAnnotation*","ValueAnnotation*"]),Association:je(["Name"],["End*","ReferentialConstraint","TypeAnnotation*","ValueAnnotation*"]),AssociationSet:je(["Name","Association"],["End*","TypeAnnotation*","ValueAnnotation*"]),Binary:je(null,null,!0),Bool:je(null,null,!0),Collection:je(null,["String*","Int*","Float*","Decimal*","Bool*","DateTime*","DateTimeOffset*","Guid*","Binary*","Time*","Collection*","Record*"]),CollectionType:je(["ElementType","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","SRID"]["TypeRef"]),ComplexType:je(["Name","BaseType","Abstract"],["Property*","TypeAnnotation*","ValueAnnotation*"]),DateTime:je(null,null,!0),DateTimeOffset:je(null,null,!0),Decimal:je(null,null,!0),DefiningExpression:je(null,null,!0),Dependent:je(["Role"],["PropertyRef*"]),Documentation:je(null,null,!0),End:je(["Type","Role","Multiplicity","EntitySet"],["OnDelete"]),EntityContainer:je(["Name","Extends"],["EntitySet*","AssociationSet*","FunctionImport*","TypeAnnotation*","ValueAnnotation*"]),EntitySet:je(["Name","EntityType"],["TypeAnnotation*","ValueAnnotation*"]),EntityType:je(["Name","BaseType","Abstract","OpenType"],["Key","Property*","NavigationProperty*","TypeAnnotation*","ValueAnnotation*"]),EnumType:je(["Name","UnderlyingType","IsFlags"],["Member*"]),Float:je(null,null,!0),Function:je(["Name","ReturnType"],["Parameter*","DefiningExpression","ReturnType","TypeAnnotation*","ValueAnnotation*"]),FunctionImport:je(["Name","ReturnType","EntitySet","IsSideEffecting","IsComposable","IsBindable","EntitySetPath"],["Parameter*","ReturnType","TypeAnnotation*","ValueAnnotation*"]),Guid:je(null,null,!0),Int:je(null,null,!0),Key:je(null,["PropertyRef*"]),LabeledElement:je(["Name"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),Member:je(["Name","Value"]),NavigationProperty:je(["Name","Relationship","ToRole","FromRole","ContainsTarget"],["TypeAnnotation*","ValueAnnotation*"]),Null:je(null,null),OnDelete:je(["Action"]),Path:je(null,null,!0),Parameter:je(["Name","Type","Mode","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode","SRID"],["CollectionType","ReferenceType","RowType","TypeRef","TypeAnnotation*","ValueAnnotation*"]),Principal:je(["Role"],["PropertyRef*"]),Property:je(["Name","Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode","CollectionKind","SRID"],["CollectionType","ReferenceType","RowType","TypeAnnotation*","ValueAnnotation*"]),PropertyRef:je(["Name"]),PropertyValue:je(["Property","Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),ReferenceType:je(["Type"]),ReferentialConstraint:je(null,["Principal","Dependent"]),ReturnType:je(["ReturnType","Type","EntitySet"],["CollectionType","ReferenceType","RowType"]),RowType:je(["Property*"]),String:je(null,null,!0),Schema:je(["Namespace","Alias"],["Using*","EntityContainer*","EntityType*","Association*","ComplexType*","Function*","ValueTerm*","Annotations*"]),Time:je(null,null,!0),TypeAnnotation:je(["Term","Qualifier"],["PropertyValue*"]),TypeRef:je(["Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","SRID"]),Using:je(["Namespace","Alias"]),ValueAnnotation:je(["Term","Qualifier","Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time"],["Path","String","Int","Float","Decimal","Bool","DateTime","DateTimeOffset","Guid","Binary","Time","Collection","Record","LabeledElement","Null"]),ValueTerm:je(["Name","Type"],["TypeAnnotation*","ValueAnnotation*"]),Edmx:je(["Version"],["DataServices","Reference*","AnnotationsReference*"],!1,h9),DataServices:je(null,["Schema*"],!1,h9)}},dz=["m:FC_ContentKind","m:FC_KeepInContent","m:FC_NsPrefix","m:FC_NsUri","m:FC_SourcePath","m:FC_TargetPath"];ji.elements.Property.attributes=ji.elements.Property.attributes.concat(dz),ji.elements.EntityType.attributes=ji.elements.EntityType.attributes.concat(dz),ji.elements.Edmx={attributes:["Version"],elements:["DataServices"],ns:h9},ji.elements.DataServices={elements:["Schema*"],ns:h9},ji.elements.EntityContainer.attributes.push("m:IsDefaultEntityContainer"),ji.elements.Property.attributes.push("m:MimeType"),ji.elements.FunctionImport.attributes.push("m:HttpMethod"),ji.elements.FunctionImport.attributes.push("m:IsAlwaysBindable"),ji.elements.EntityType.attributes.push("m:HasStream"),ji.elements.DataServices.attributes=["m:DataServiceVersion","m:MaxDataServiceVersion"];var S=function(b){if(!b){return b}if(b.length>1){var a=b.substr(0,2);return a===a.toUpperCase()?b:b.charAt(0).toLowerCase()+b.substr(1)}return b.charAt(0).toLowerCase()},gB=function(l,c){var d,a,h,b,g,k;if(c==="Documentation"){return{isArray:!0,propertyName:"documentation"}}if(d=l.elements,!d){return null}for(a=0,h=d.length;a<h;a++){if(b=d[a],g=!1,b.charAt(b.length-1)==="*"&&(g=!0,b=b.substr(0,b.length-1)),c===b){return k=S(b),{isArray:g,propertyName:k}}}return null},jg=/^(m:FC_.*)_[0-9]+$/,jQ=function(a){return a===fS||a===cG||a===aZ||a===hz||a===hV||a===dN},d5=function(h){var g=jl(h),f=iV(h),b=ji.elements[g];if(!b){return null}if(b.ns){if(f!==b.ns){return null}}else{if(!jQ(f)){return null}}var a={},d=[],c=b.attributes||[];return j3(h,function(v){var u=jl(v),s=iV(v),k=v.value,p,t,r;s!==dH&&(p=null,t=!1,jQ(s)||s===null?p="":s===jp&&(p="m:"),p!==null&&(p+=u,r=jg.exec(p),r&&(p=r[1]),aU(c,p)&&(t=!0,a[S(u)]=k)),t||d.push(A(v)))}),iO(h,function(p){var l=jl(p),i=gB(b,l),k;i?i.isArray?(k=a[i.propertyName],k||(k=[],a[i.propertyName]=k),k.push(d5(p))):a[i.propertyName]=d5(p):d.push(kD(p))}),b.text&&(a.text=ju(h)),d.length&&(a.extensions=d),a},eR=function(d,b){var c=hM(b),a=iS(c);return d5(a)||iX};i1.metadataHandler=dO(eR,null,e1,hW);var fD="o",bC="f",iM="p",g2="c",dZ="s",bm="l",j5="odata",ij=j5+".",aF="@"+ij+"bind",fP=ij+"metadata",fJ=ij+"navigationLinkUrl",d3=ij+"type",eq={readLink:"self",editLink:"edit",nextLink:"__next",mediaReadLink:"media_src",mediaEditLink:"edit_media",mediaContentType:"content_type",mediaETag:"media_etag",count:"__count",media_src:"mediaReadLink",edit_media:"mediaEditLink",content_type:"mediaContentType",media_etag:"mediaETag",url:"uri"},kL=function(d){if(d.indexOf(".")>0){var b=d.indexOf("@"),c=b>-1?d.substring(0,b):null,a=d.substring(b+1);return{target:c,name:a,isOData:a.indexOf(ij)===0}}return null},cD=function(e,c,b,d,a){return jc(c)&&c[d3]||b&&b[e+"@"+d3]||d&&d.type||bQ(d,a)||null},cq=function(b,a){return a?J(a.property,b)||J(a.navigationProperty,b):null},aP=function(a){return jc(a)&&a.hasOwnProperty(ij+"id")},c8=function(d,b,a){if(!!b[d+"@"+fJ]||a&&a.relationship){return !0}var c=jo(b[d])?b[d][0]:b[d];return aP(c)},aW=function(a){return cL(a)||bK(a)||fW(a)},gM=function(d,y,g,a,w){var l,p;for(l in d){if(l.indexOf(".")>0&&l.charAt(0)!=="#"&&(p=kL(l),p)){var v=p.name,b=p.target,aa=null,k=null;b&&(aa=cq(b,a),k=cD(b,d[b],d,aa,w)),p.isOData?L(v,b,k,d[l],d,y,g):y[l]=d[l]}}return y};5;var L=function(l,c,b,d,a,g,h){var k=l.substring(ij.length);switch(k){case"navigationLinkUrl":gW(k,c,b,d,a,g,h);return;case"nextLink":case"count":fq(k,c,d,g,h);return;case"mediaReadLink":case"mediaEditLink":case"mediaContentType":case"mediaETag":iF(k,c,b,d,g,h);return;default:jK(k,c,d,g,h);return}},jK=function(c,l,d,a,k){var g=a.__metadata=a.__metadata||{},h=eq[c]||c,p,b;if(c==="editLink"){g.uri=jh(d,k),g[h]=g.uri;return}if((c==="readLink"||c==="associationLinkUrl")&&(d=jh(d,k)),l){if(p=g.properties=g.properties||{},b=p[l]=p[l]||{},c==="type"){b[h]=b[h]||d;return}b[h]=d;return}g[h]=d},fq=function(k,c,b,d,a){var g=eq[k],h=c?d[c]:d;h[g]=k==="nextLink"?jh(b,a):b},iF=function(d,v,g,a,p,h){var k=p.__metadata=p.__metadata||{},l=eq[d],b,w;if((d==="mediaReadLink"||d==="mediaEditLink")&&(a=jh(a,h)),v){b=k.properties=k.properties||{},w=b[v]=b[v]||{},w.type=w.type||g,p.__metadata=k,p[v]=p[v]||{__mediaresource:{}},p[v].__mediaresource[l]=a;return}k[l]=a},gW=function(d,y,h,a,w,k,p){var aa=k.__metadata=k.__metadata||{},v=aa.properties=aa.properties||{},b=v[y]=v[y]||{},g=jh(a,p);if(w.hasOwnProperty(y)){b.navigationLinkUrl=g;return}k[y]={__deferred:{uri:g}},b.type=b.type||h},hm=function(h,c,b,d,a,e,g){if(typeof h=="string"){return d6(h,c,g)}if(!aW(c)){if(jo(h)){return g5(h,c,b,d,e,g)}if(jc(h)){return bD(h,c,b,d,e,g)}}return h},d6=function(c,b,a){switch(b){case eG:return b5(c);case f5:return cV(c,!1);case iU:return dS(c,!1)}return a?cV(c,!0)||dS(c,!0)||c:c},g5=function(g,af,p,b,ae,y){for(var ac=jU(af),d=[],w=[],aa=0,ab=g.length;aa<ab;aa++){var ag=cD(null,g[aa])||ac,k={type:ag},ad=hm(g[aa],ag,k,b,null,ae,y);aW(ag)||kA(g[aa])||d.push(k),w.push(ad)}return d.length>0&&(p.elements=d),{__metadata:{type:af},results:w}},bD=function(c,l,d,a,k,g){var h=bJ(c,l,a,k,g),b=h.__metadata,p=b.properties;return p&&(d.properties=p,delete b.properties),h},cE=function(e,c,b,d,a){return jo(e)?dC(e,c,b,d,a):jc(e)?bJ(e,c,b,d,a):null},bJ=function(k,ak,aa,b,ai){var ad=k[d3]||ak,ah=fj(ad,b)||jI(ad,b),g={type:ad},al={__metadata:g},ab={},ac;for(ac in k){if(ac.indexOf("#")===0){hL(ac.substring(1),k[ac],al,aa,b)}else{if(ac.indexOf(".")===-1){g.properties||(g.properties=ab);var ae=k[ac],w=cq(ac,ah),af=c8(ac,k,w),ag=cD(ac,ae,k,w,b),d=ab[ac]=ab[ac]||{type:ag};al[ac]=af?cE(ae,ag,aa,b,ai):hm(ae,ag,d,aa,w,b,ai)}}}return gM(k,al,aa,ah,b)},hL=function(ah,ac,ak,ae,ab){var an,ad,al,au;if(ah&&(jo(ac)||jc(ac))){var ai=!1,ap=ah.lastIndexOf("."),at=ah.substring(ap+1),aa=ap>-1?ah.substring(0,ap):"",h=at===ah||aa.indexOf(".")===-1?gV(ab):eA(aa,ab);h&&(an=dB(h.functionImport,at),an&&!!an.isSideEffecting&&(ai=!h1(an.isSideEffecting)));for(var af=ak.__metadata,k=ai?"functions":"actions",e=jh(ah,ae),ar=jo(ac)?ac:[ac],ag=0,ao=ar.length;ag<ao;ag++){ad=ar[ag],ad&&(al=af[k]=af[k]||[],au={metadata:e,title:ad.title,target:jh(ad.target,ae)},al.push(au))}}},dC=function(d,y,g,a,w){for(var k=jo(d)?d:d.value,v=[],p,aa,b=0,e=k.length;b<e;b++){v.push(bJ(k[b],y,g,a,w))}if(p={results:v},jc(d)){for(aa in d){aa.indexOf("#")===0&&(p.__metadata=p.__metadata||{},hL(aa.substring(1),d[aa],p,g,a))}p=gM(d,p,g)}return p},aX=function(g,c,b,d){var a={type:c},e=hm(g.value,c,a,b,null,null,d);return gM(g,{__metadata:a,value:e},b)},hq=function(k,c,b,d,a){var g={},h=g5(k.value,c,g,b,d,a);return bx(h.__metadata,g),gM(k,h,b)},hT=function(h,c){var d=h.value,a,b,e,g;if(!jo(d)){return bR(h,c)}for(a=[],b=0,e=d.length;b<e;b++){a.push(bR(d[b],c))}return g={results:a},gM(h,g,c)},bR=function(e,c){var b={uri:jh(e.url,c)},a,d;return b=gM(e,b,c),a=b.__metadata||{},d=a.properties||{},cK(d.url),fK(d,"url","uri"),b},cK=function(a){a&&delete a.type},dK=function(d,y){var b=d.value,aa=[],v=gM(d,{collections:aa},y),p=v.__metadata||{},h=p.properties||{},w,g,k,a;for(cK(h.value),fK(h,"value","collections"),w=0,g=b.length;w<g;w++){k=b[w],a={title:k.name,href:jh(k.url,y)},a=gM(k,a,y),p=a.__metadata||{},h=p.properties||{},cK(h.name),cK(h.url),fK(h,"name","title"),fK(h,"url","href"),aa.push(a)}return{workspaces:[v]}},d9=function(b,a){return{kind:b,type:a||null}},bY=function(k,an,ab){var al=k[fP],g,ae,ad,aa,ac,d,ah,ao,ak,ag;if(!al||typeof al!="string"){return null}if(g=al.lastIndexOf("#"),g===-1){return d9(dZ)}if(ae=al.indexOf("@Element",g),ad=ae-1,ad<0&&(ad=al.indexOf("?",g),ad===-1&&(ad=al.length)),aa=al.substring(g+1,ad),aa.indexOf("/$links/")>0){return d9(bm)}if(ac=aa.split("/"),ac.length>=0){if(d=ac[0],ah=ac[1],aW(d)){return d9(iM,d)}if(X(d)){return d9(g2,d)}if(ao=ah,!ah){var e=d.lastIndexOf("."),ai=d.substring(e+1),af=ai===d?gV(an):eA(d.substring(0,e),an);af&&(ak=hK(af.entitySet,ai),ao=!ak?null:ak.entityType)}return ae>0?d9(fD,ao):ao?d9(bC,ao):jo(k.value)&&!jI(d,an)&&(ag=k.value[0],!kA(ag)&&(aP(ag)||!ab))?d9(bC,null):d9(fD,d)}return null},gm=function(k,c,b,d){if(!jc(k)){return k}var a=k[fP],h=bY(k,c,d),g=null;if(h){delete k[fP],g=h.type;switch(h.kind){case bC:return dC(k,g,a,c,b);case g2:return hq(k,g,a,c,b);case iM:return aX(k,g,a,b);case dZ:return dK(k,a);case bm:return hT(k,a)}}return bJ(k,g,a,c,b)},f4=["type","etag","media_src","edit_media","content_type","media_etag"],iR=function(g,c){var a=/\/\$links\//,b={},d=g.__metadata,e=c&&a.test(c.request.requestUri);return hS(g,d&&d.properties,b,e),b},i6=function(g,c){var b,a,d,e;if(g){for(b=0,a=f4.length;b<a;b++){d=f4[b],e=ij+(eq[d]||d),e4(e,null,g[d],c)}}},hS=function(g,c,b,d){var a,e;for(a in g){e=g[a],a==="__metadata"?i6(e,b):a.indexOf(".")===-1?d&&a==="uri"?j0(e,b):eM(a,e,c,b,d):b[a]=e}},eM=function(h,b,c,a){var g=c&&c[h]||{properties:iX,type:iX},d=hO(b,g);if(kA(b)||!b){e4(d3,h,d,a),a[h]=b;return}if(jX(b,d)||jJ(b)){c2(h,b,a);return}if(!d&&K(b)){az(h,b,a);return}if(c7(b,d)){jU(d)&&e4(d3,h,d,a),kG(h,b,a);return}a[h]={},e4(d3,null,d,a[h]),hS(b,g.properties,a[h])},j0=function(b,a){a.url=b},az=function(c,b,a){e4(fJ,c,b.__deferred.uri,a)},kG=function(d,b,a){a[d]=[];var c=jo(b)?b:b.results;hS(c,null,a[d])},c2=function(g,c,b){if(jX(c)){b[g]=[];for(var a=jo(c)?c:c.results,d=0,e=a.length;d<e;d++){eF(g,a[d],!0,b)}return}eF(g,c,!1,b)},eF=function(g,c,b,d){var e=c.__metadata&&c.__metadata.uri,a;if(e){F(g,e,b,d);return}if(a=iR(c),b){d[g].push(a);return}d[g]=a},F=function(e,c,b,d){var a=e+aF;if(b){d[a]=d[a]||[],d[a].push(c);return}d[a]=c},e4=function(d,b,c,a){c!==iX&&(b?a[b+"@"+d]=c:a[d]=c)},jT="application/json",W=iD(jT),kz=function(d){var b=[],a,c;for(name in d){for(a=0,c=d[name].length;a<c;a++){b.push(bx({metadata:name},d[name][a]))}}return b},jF=function(g,af,p,b){var w,ae,ab,aa,d,ad,ac;if(g&&typeof g=="object"){if(ae=g.__metadata,ae&&(ae.actions&&(ae.actions=kz(ae.actions)),ae.functions&&(ae.functions=kz(ae.functions)),w=ae&&ae.type),ab=fj(w,af)||jI(w,af),ab){if(aa=ab.property,aa){for(d=0,ad=aa.length;d<ad;d++){var ag=aa[d],k=ag.name,y=g[k];if(ag.type==="Edm.DateTime"||ag.type==="Edm.DateTimeOffset"){if(y){if(y=p(y),!y){throw {message:"Invalid date/time value"}}g[k]=y}}else{ag.type==="Edm.Time"&&(g[k]=b5(y))}}}}else{if(b){for(ac in g){y=g[ac],typeof y=="string"&&(g[ac]=p(y)||y)}}}}return g},cU=function(b){if(b){var a=b.properties.odata;return a==="nometadata"||a==="minimalmetadata"||a==="fullmetadata"}return !1},e7=function(k,c){for(var a={collections:[]},d,h,b=0,g=k.EntitySets.length;b<g;b++){d=k.EntitySets[b],h={title:d,href:jh(d,c)},a.collections.push(h)}return{workspaces:[a]}},iz=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/,gR=function(c){var b,a;return c<0?(b="-",c=-c):b="+",a=Math.floor(c/60),c=c-60*a,b+ja(a,2)+":"+ja(c,2)},c6=function(e){var c=e&&iz.exec(e),b,d,a;if(c&&(b=new Date(iZ(c[1])),c[2]&&(d=iZ(c[3]),c[2]==="-"&&(d=-d),a=b.getUTCMinutes(),b.setUTCMinutes(a-d),b.__edmType="Edm.DateTimeOffset",b.__offset=gR(d)),!isNaN(b.valueOf()))){return b}},iC=function(n,c,a){var g=d1(a.recognizeDates,n.recognizeDates),d=d1(a.inferJsonLightFeedAsObject,n.inferJsonLightFeedAsObject),k=a.metadata,b=a.dataServiceVersion,p=c6,l=typeof c=="string"?i8.JSON.parse(c):c;if(bT("3.0",b)===b){if(cU(a.contentType)){return gm(l,k,g,d)}p=cV}return l=jS(l.d,function(f,e){return jF(e,k,p,g)}),l=dD(l,a.dataServiceVersion),fF(l,a.response.requestUri)},x=function(b){var c=iX,a=Date.prototype.toJSON;try{Date.prototype.toJSON=function(){return j4(this)},c=i8.JSON.stringify(b,cZ)}finally{Date.prototype.toJSON=a}return c},fI=function(k,b,c){var g=c.dataServiceVersion||"1.0",h=d1(c.useJsonLight,k.useJsonLight),a=c.contentType=c.contentType||W,d;return a&&a.mediaType===W.mediaType?(d=b,h||cU(a))?(c.dataServiceVersion=bT(g,"3.0"),d=iR(b,c),x(d)):(bT("3.0",g)===g&&(a.properties.odata="verbose",c.contentType=a),x(d)):iX},cZ=function(b,a){return a&&a.__edmType==="Edm.Time"?aD(a):a},fF=function(c,b){var a=jc(c)&&!c.__metadata&&jo(c.EntitySets);return a?e7(c,b):c},dD=function(b,a){return a&&a.lastIndexOf(";")===a.length-1&&(a=a.substr(0,a.length-1)),a&&a!=="1.0"||jo(b)&&(b={results:b}),b},a3=dO(iC,fI,jT,hW);a3.recognizeDates=!1,a3.useJsonLight=!1,a3.inferJsonLightFeedAsObject=!1,i1.jsonHandler=a3;var iq="multipart/mixed",fQ=/^HTTP\/1\.\d (\d{3}) (.*)$/i,am=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/,dJ=function(){return Math.floor((1+Math.random())*65536).toString(16).substr(1)},jy=function(a){return a+dJ()+"-"+dJ()+"-"+dJ()},e0=function(a){return a.handler.partHandler},h8=function(b){var a=b.boundaries;return a[a.length-1]},U=function(d,b,a){var c=a.contentType.properties.boundary;return{__batchResponses:gK(b,{boundaries:[c],handlerContext:a})}},i5=function(d,b,a){var c=a.contentType=a.contentType||iD(iq);if(c.mediaType===iq){return aS(b,a)}},gK=function(c,v){var k="--"+h8(v),p,b,w,a,l,d;for(hD(c,v,k),bA(c,v),p=[];b!=="--"&&v.position<c.length;){if(w=dX(c,v),a=iD(w["Content-Type"]),a&&a.mediaType===iq){v.boundaries.push(a.properties.boundary);try{l=gK(c,v)}catch(g){g.response=a9(c,v,k),l=[g]}p.push({__changeResponses:l}),v.boundaries.pop(),hD(c,v,"--"+h8(v))}else{if(!a||a.mediaType!=="application/http"){throw {message:"invalid MIME part type "}}bA(c,v),d=a9(c,v,k);try{d.statusCode>=200&&d.statusCode<=299?e0(v.handlerContext).read(d,v.handlerContext):d={message:"HTTP request failed",response:d}}catch(g){d=g}p.push(d)}b=c.substr(v.position,2),bA(c,v)}return p},dX=function(g,c){var d={},b,a,e;do{e=c.position,a=bA(g,c),b=am.exec(a),b!==null?d[b[1]]=b[2]:c.position=e}while(a&&b);return hE(d),d},a9=function(l,c,b){var k=c.position,d=fQ.exec(bA(l,c)),a,g,h;return d?(a=d[1],g=d[2],h=dX(l,c),bA(l,c)):c.position=k,{statusCode:a,statusText:g,headers:h,body:hD(l,c,"\r\n"+b)}},bA=function(b,a){return hD(b,a,"\r\n")},hD=function(e,c,b){var a=c.position||0,d=e.length;if(b){if(d=e.indexOf(b,a),d===-1){return null}c.position=d+b.length}else{c.position=d}return e.substring(a,d)},aS=function(l,c){var k;if(!cm(l)){throw {message:"Data is not a batch object."}}for(var d=jy("batch_"),g=l.__batchRequests,a="",b=0,h=g.length;b<h;b++){a+=h0(d,!1)+fG(g[b],c)}return a+=h0(d,!0),k=c.contentType.properties,k.boundary=d,a},h0=function(c,b){var a="\r\n--"+c;return b&&(a+="--"),a+"\r\n"},fG=function(c,l,d){var p=c.__changeRequests,a,g,b,e,k;if(jo(p)){if(d){throw {message:"Not Supported: change set nested in other change set"}}for(g=jy("changeset_"),a="Content-Type: "+iq+"; boundary="+g+"\r\n",b=0,e=p.length;b<e;b++){a+=h0(g,!1)+fG(p[b],l,!0)}a+=h0(g,!0)}else{a="Content-Type: application/http\r\nContent-Transfer-Encoding: binary\r\n\r\n",k=bx({},l),k.handler=dO,k.request=c,k.contentType=null,hG(c,e0(l),k),a+=iP(c)}return a},iP=function(c){var b=(c.method?c.method:"GET")+" "+c.requestUri+" HTTP/1.1\r\n",a;for(a in c.headers){c.headers[a]&&(b=b+a+": "+c.headers[a]+"\r\n")}return b+="\r\n",c.body&&(b+=c.body),b};i1.batchHandler=dO(U,i5,iq,hW),bX=[i1.jsonHandler,i1.atomHandler,i1.xmlHandler,i1.textHandler],gj=function(e,c,b){for(var d=0,a=bX.length;d<a&&!bX[d][e](c,b);d++){}if(d===a){throw {message:"no handler for data"}}},i1.defaultSuccess=function(a){i8.alert(i8.JSON.stringify(a))},i1.defaultError=cx,i1.defaultHandler={read:function(b,a){b&&jV(b.body)&&b.headers["Content-Type"]&&gj("read",b,a)},write:function(b,a){gj("write",b,a)},maxDataServiceVersion:hW,accept:"application/atomsvc+xml;q=0.8, application/json;odata=fullmetadata;q=0.7, application/json;q=0.5, */*;q=0.1"},i1.defaultMetadata=[],i1.read=function(k,c,b,a,d,g){var h;return h=k instanceof String||typeof k=="string"?{requestUri:k}:k,i1.request(h,c,b,a,d,g)},i1.request=function(l,c,b,a,g,h){c=c||i1.defaultSuccess,b=b||i1.defaultError,a=a||i1.defaultHandler,g=g||i1.defaultHttpClient,h=h||i1.defaultMetadata,l.recognizeDates=d1(l.recognizeDates,i1.jsonHandler.recognizeDates),l.callbackParameterName=d1(l.callbackParameterName,i1.defaultHttpClient.callbackParameterName),l.formatQueryString=d1(l.formatQueryString,i1.defaultHttpClient.formatQueryString),l.enableJsonpCallback=d1(l.enableJsonpCallback,i1.defaultHttpClient.enableJsonpCallback),l.useJsonLight=d1(l.useJsonLight,i1.jsonHandler.enableJsonpCallback),l.inferJsonLightFeedAsObject=d1(l.inferJsonLightFeedAsObject,i1.jsonHandler.inferJsonLightFeedAsObject);var k={metadata:h,recognizeDates:l.recognizeDates,callbackParameterName:l.callbackParameterName,formatQueryString:l.formatQueryString,enableJsonpCallback:l.enableJsonpCallback,useJsonLight:l.useJsonLight,inferJsonLightFeedAsObject:l.inferJsonLightFeedAsObject};try{return hG(l,a,k),fH(l,c,b,a,g,k)}catch(d){b(d)}},i1.batchHandler.partHandler=i1.defaultHandler;var aR=null,fX=function(){var a={v:this.valueOf(),t:"[object Date]"},b;for(b in this){a[b]=this[b]}return a},cR=function(d,b){var c,a;if(b&&b.t==="[object Date]"){c=new Date(b.v);for(a in b){a!=="t"&&a!=="v"&&(c[a]=b[a])}b=c}return b},dR=function(b,a){return b.name+"#!#"+a},cj=function(b,a){return a.replace(b.name+"#!#","")},iT=function(a){this.name=a};iT.create=function(a){if(iT.isSupported()){return aR=aR||i8.localStorage,new iT(a)}throw {message:"Web Storage not supported by the browser"}},iT.isSupported=function(){return !!i8.localStorage},iT.prototype.add=function(e,c,b,d){d=d||this.defaultError;var a=this;this.contains(e,function(g){g?i7(d,{message:"key already exists",key:e}):a.addOrUpdate(e,c,b,d)},d)},iT.prototype.addOrUpdate=function(b,k,a,l){var g,d,n;if(l=l||this.defaultError,b instanceof Array){l({message:"Array of keys not supported"})}else{g=dR(this,b),d=Date.prototype.toJSON;try{n=k,n!==iX&&(Date.prototype.toJSON=fX,n=i8.JSON.stringify(k)),aR.setItem(g,n),i7(a,b,k)}catch(o){o.code===22||o.number===2147942414?i7(l,{name:"QUOTA_EXCEEDED_ERR",error:o}):i7(l,o)}finally{Date.prototype.toJSON=d}}},iT.prototype.clear=function(k,c){var b,d,a,g;c=c||this.defaultError;try{for(b=0,d=aR.length;d>0&&b<d;){a=aR.key(b),g=cj(this,a),a!==g?(aR.removeItem(a),d=aR.length):b++}i7(k)}catch(h){i7(c,h)}},iT.prototype.close=function(){},iT.prototype.contains=function(g,c,b){b=b||this.defaultError;try{var d=dR(this,g),a=aR.getItem(d);i7(c,a!==null)}catch(e){i7(b,e)}},iT.prototype.defaultError=cx,iT.prototype.getAllKeys=function(l,c){var g,b,k,a,h;c=c||this.defaultError,g=[];try{for(b=0,k=aR.length;b<k;b++){a=aR.key(b),h=cj(this,a),a!==h&&g.push(h)}i7(l,g)}catch(d){i7(c,d)}},iT.prototype.mechanism="dom",iT.prototype.read=function(b,d,a){if(a=a||this.defaultError,b instanceof Array){a({message:"Array of keys not supported"})}else{try{var h=dR(this,b),g=aR.getItem(h);g=g!==null&&g!=="undefined"?i8.JSON.parse(g,cR):iX,i7(d,b,g)}catch(c){i7(a,c)}}},iT.prototype.remove=function(e,c,b){if(b=b||this.defaultError,e instanceof Array){b({message:"Batches not supported"})}else{try{var d=dR(this,e);aR.removeItem(d),i7(c)}catch(a){i7(b,a)}}},iT.prototype.update=function(e,c,b,d){d=d||this.defaultError;var a=this;this.contains(e,function(g){g?a.addOrUpdate(e,c,b,d):i7(d,{message:"key not found",key:e})},d)};var aN=i8.mozIndexedDB||i8.webkitIndexedDB||i8.msIndexedDB||i8.indexedDB,fE=i8.IDBKeyRange||i8.webkitIDBKeyRange,g3=i8.IDBTransaction||i8.webkitIDBTransaction||{},hJ=g3.READ_ONLY||"readonly",fN=g3.READ_WRITE||"readwrite",eH=function(b,a){return function(d){var g=b||a,c,h;if(g){if(Object.prototype.toString.call(d)==="[object IDBDatabaseException]"){if(d.code===11){g({name:"QuotaExceededError",error:d});return}g(d);return}try{h=d.target.error||d,c=h.name}catch(k){c=d.type==="blocked"?"IndexedDBBlocked":"UnknownError"}g({name:c,error:d})}}},iL=function(g,c,b){var a=g.name,e="_datajs_"+a,d=aN.open(e);d.onblocked=b,d.onerror=b,d.onupgradeneeded=function(){var f=d.result;f.objectStoreNames.contains(a)||f.createObjectStore(a)},d.onsuccess=function(k){var h=d.result,i;if(!h.objectStoreNames.contains(a)){if("setVersion" in h){i=h.setVersion("1.0"),i.onsuccess=function(){var f=i.transaction;f.oncomplete=function(){c(h)},h.createObjectStore(a,null,!1)},i.onerror=b,i.onblocked=b;return}k.target.error={name:"DBSchemaMismatch"},b(k);return}h.onversionchange=function(f){f.target.close()},c(h)}},bG=function(k,c,b,d){var a=k.name,g=k.db,h=eH(d,k.defaultError);if(g){b(g.transaction(a,c));return}iL(k,function(e){k.db=e,b(e.transaction(a,c))},h)},i4=function(a){this.name=a};i4.create=function(a){if(i4.isSupported()){return new i4(a)}throw {message:"IndexedDB is not supported on this browser"}},i4.isSupported=function(){return !!aN},i4.prototype.add=function(l,c,b,d){var h=this.name,k=this.defaultError,a=[],g=[];l instanceof Array?(a=l,g=c):(a=[l],g=[c]),bG(this,fN,function(f){f.onabort=eH(d,k,l,"add"),f.oncomplete=function(){l instanceof Array?b(a,g):b(l,c)};for(var e=0;e<a.length&&e<g.length;e++){f.objectStore(h).add({v:g[e]},a[e])}},d)},i4.prototype.addOrUpdate=function(l,c,b,d){var h=this.name,k=this.defaultError,a=[],g=[];l instanceof Array?(a=l,g=c):(a=[l],g=[c]),bG(this,fN,function(f){var e,i;for(f.onabort=eH(d,k),f.oncomplete=function(){l instanceof Array?b(a,g):b(l,c)},e=0;e<a.length&&e<g.length;e++){i={v:g[e]},f.objectStore(h).put(i,a[e])}},d)},i4.prototype.clear=function(d,b){var a=this.name,c=this.defaultError;bG(this,fN,function(e){e.onerror=eH(b,c),e.oncomplete=function(){d()},e.objectStore(a).clear()},b)},i4.prototype.close=function(){this.db&&(this.db.close(),this.db=null)},i4.prototype.contains=function(e,c,b){var d=this.name,a=this.defaultError;bG(this,hJ,function(g){var h=g.objectStore(d),i=h.get(e);g.oncomplete=function(){c(!!i.result)},g.onerror=eH(b,a)},b)},i4.prototype.defaultError=cx,i4.prototype.getAllKeys=function(d,b){var a=this.name,c=this.defaultError;bG(this,fN,function(g){var i=[],h;g.oncomplete=function(){d(i)},h=g.objectStore(a).openCursor(),h.onerror=eH(b,c),h.onsuccess=function(f){var e=f.target.result;e&&(i.push(e.key),e["continue"].call(e))}},b)},i4.prototype.mechanism="indexeddb",i4.prototype.read=function(h,b,c){var d=this.name,g=this.defaultError,a=h instanceof Array?h:[h];bG(this,hJ,function(k){var i=[],f,n,e;for(k.onerror=eH(c,g,h,"read"),k.oncomplete=function(){h instanceof Array?b(a,i):b(a[0],i[0])},f=0;f<a.length;f++){n=k.objectStore(d),e=n.get.call(n,a[f]),e.onsuccess=function(o){var l=o.target.result;i.push(l?l.v:iX)}}},c)},i4.prototype.remove=function(g,c,b){var a=this.name,e=this.defaultError,d=g instanceof Array?g:[g];bG(this,fN,function(i){var f,h;for(i.onerror=eH(b,e),i.oncomplete=function(){c()},f=0;f<d.length;f++){h=i.objectStore(a),h["delete"].call(h,d[f])}},b)},i4.prototype.update=function(l,c,b,d){var h=this.name,k=this.defaultError,a=[],g=[];l instanceof Array?(a=l,g=c):(a=[l],g=[c]),bG(this,fN,function(i){var f,n,e;for(i.onabort=eH(d,k),i.oncomplete=function(){l instanceof Array?b(a,g):b(l,c)},f=0;f<a.length&&f<g.length;f++){n=i.objectStore(h).openCursor(fE.only(a[f])),e={v:g[f]},n.pair={key:a[f],value:e},n.onsuccess=function(p){var o=p.target.result;o?o.update(p.target.pair.value):i.abort()}}},d)},fT=function(h){var g=[],c=[],b={},a,d;this.name=h,a=function(e){return e||this.defaultError},d=function(k,e){var f;return(k instanceof Array&&(f="Array of keys not supported"),(k===iX||k===null)&&(f="Invalid key"),f)?(i7(e,{message:f}),!1):!0},this.add=function(l,f,i,k){k=a(k),d(l,k)&&(b.hasOwnProperty(l)?k({message:"key already exists",key:l}):this.addOrUpdate(l,f,i,k))},this.addOrUpdate=function(o,i,f,k){if(k=a(k),d(o,k)){var e=b[o];e===iX&&(e=g.length>0?g.splice(0,1):c.length),c[e]=i,b[o]=e,i7(f,o,i)}},this.clear=function(e){c=[],b={},g=[],i7(e)},this.contains=function(i,e){var f=b.hasOwnProperty(i);i7(e,f)},this.getAllKeys=function(i){var e=[],f;for(f in b){e.push(f)}i7(i,e)},this.read=function(l,f,k){if(k=a(k),d(l,k)){var i=b[l];i7(f,l,c[i])}},this.remove=function(k,f,e){if(e=a(e),d(k,e)){var i=b[k];i!==iX&&(i===c.length-1?c.pop():(c[i]=iX,g.push(i)),delete b[k],c.length===0&&(g=[])),i7(f)}},this.update=function(l,f,i,k){k=a(k),d(l,k)&&(b.hasOwnProperty(l)?this.addOrUpdate(l,f,i,k):k({message:"key not found",key:l}))}},fT.create=function(a){return new fT(a)},fT.isSupported=function(){return !0},fT.prototype.close=function(){},fT.prototype.defaultError=cx,fT.prototype.mechanism="memory",dA={indexeddb:i4,dom:iT,memory:fT},a0.defaultStoreMechanism="best",a0.createStore=function(c,b){b||(b=a0.defaultStoreMechanism),b==="best"&&(b=iT.isSupported()?"dom":"memory");var a=dA[b];if(a){return a.create(c)}throw {message:"Failed to create store",name:c,mechanism:b}};var P=function(c,b){var a=c.indexOf("?")>=0?"&":"?";return c+a+b},dL=function(d,b){var a=d.indexOf("?"),c="";return a>=0&&(c=d.substr(a),d=d.substr(0,a)),d[d.length-1]!=="/"&&(d+="/"),d+b+c},bP=function(b,a){return{method:"GET",requestUri:b,user:a.user,password:a.password,enableJsonpCallback:a.enableJsonpCallback,callbackParameterName:a.callbackParameterName,formatQueryString:a.formatQueryString}},j=function(e,c){var a=-1,d=e.indexOf("?"),b;return d!==-1&&(b=e.indexOf("?"+c+"=",d),b===-1&&(b=e.indexOf("&"+c+"=",d)),b!==-1&&(a=b+c.length+2)),a},aE=function(d,b,a,c){return f2(d,b,[],a,c)},f2=function(k,b,a,d,g){var c=bP(k,b),h=i1.request(c,function(i){var e=i.__next,f=i.results;a=a.concat(f),e?h=f2(e,b,a,d,g):d(a)},g,iX,b.httpClient,b.metadata);return{abort:function(){h.abort()}}},jk=function(c){var b=this,a=c.source;return b.identifier=fO(encodeURI(decodeURI(a))),b.options=c,b.count=function(h,d){var g=b.options;return i1.request(bP(dL(a,"$count"),g),function(f){var e=iZ(f.toString());isNaN(e)?d({message:"Count is NaN",count:e}):h(e)},d,iX,g.httpClient,g.metadata)},b.read=function(k,d,g,h){var i="$skip="+k+"&$top="+d;return aE(P(a,i),b.options,g,h)},b},aM=function(e,c){var d=hX(e,c),b,a;d&&(b=d.i-c.i,a=b+(e.c-e.d.length),e.d=e.d.concat(c.d.slice(b,a)))},hX=function(k,c){var d=k.i+k.c,a=c.i+c.c,b=k.i>c.i?k.i:c.i,g=d<a?d:a,h;return g>=b&&(h={i:b,c:g-b}),h},iN=function(b,a){if(b===iX||typeof b!="number"){throw {message:"'"+a+"' must be a number."}}if(isNaN(b)||b<0||!isFinite(b)){throw {message:"'"+a+"' must be greater than or equal to zero."}}},cO=function(b,a){if(b!==iX){if(typeof b!="number"){throw {message:"'"+a+"' must be a number."}}if(isNaN(b)||b<=0||!isFinite(b)){throw {message:"'"+a+"' must be greater than zero."}}}},eD=function(b,a){if(b!==iX&&(typeof b!="number"||isNaN(b)||!isFinite(b))){throw {message:"'"+a+"' must be a number."}}},i3=function(d,b){for(var a=0,c=d.length;a<c;a++){if(d[a]===b){return d.splice(a,1),!0}}return !1},jR=function(d){var b=0,c=typeof d,a;if(c==="object"&&d){for(a in d){b+=a.length*2+jR(d[a])}}else{b=c==="string"?d.length*2:8}return b},T=function(c,b,a){return c=Math.floor(c/a)*a,b=Math.ceil((b+1)/a)*a,{i:c,c:b-c}},b4="destroy",gz="idle",kj="init",eL="read",jZ="prefetch",ax="write",gO="cancel",cH="end",kF="error",jd="start",cS="wait",m="clear",d0="done",bq="local",jw="save",eY="source",cB=function(d,ab,k,a,aa,v,w){var p,y,b=this,g,ac;return b.p=ab,b.i=a,b.c=aa,b.d=v,b.s=jd,b.canceled=!1,b.pending=w,b.oncomplete=null,b.cancel=function(){if(k){var c=b.s;c!==kF&&c!==cH&&c!==gO&&(b.canceled=!0,ac(gO,p))}},b.complete=function(){ac(cH,p)},b.error=function(c){b.canceled||ac(kF,c)},b.run=function(c){y=c,b.transition(b.s,p)},b.wait=function(c){ac(cS,c)},g=function(e,c,f){switch(e){case jd:c!==kj&&d(b,e,c,f);break;case cS:d(b,e,c,f);break;case gO:d(b,e,c,f),b.fireCanceled(),ac(cH);break;case kF:d(b,e,c,f),b.canceled=!0,b.fireRejected(f),ac(cH);break;case cH:if(b.oncomplete){b.oncomplete(b)}b.canceled||b.fireResolved(),d(b,e,c,f);break;default:d(b,e,c,f)}},ac=function(e,c){b.s=e,p=c,g(e,y,c)},b.transition=ac,b};cB.prototype.fireResolved=function(){var a=this.p;a&&(this.p=null,a.resolve(this.d))},cB.prototype.fireRejected=function(b){var a=this.p;a&&(this.p=null,a.reject(b))},cB.prototype.fireCanceled=function(){this.fireRejected({canceled:!0,message:"Operation canceled"})},h6=function(bf){var af=kj,ao={counts:0,netReads:0,prefetches:0,cacheReads:0},bo=[],bp=[],ay=[],bh=0,bc=!1,bd=eS(bf.cacheSize,1048576),br=0,bg=0,bn=0,be=bd===0,av=eS(bf.pageSize,50),ak=eS(bf.prefetchSize,av),aa="1.0",bi,ae=0,ap=bf.source,ar,at;typeof ap=="string"&&(ap=new jk(bf)),ap.options=bf,ar=a0.createStore(bf.name,bf.mechanism),at=this,at.onidle=bf.idle,at.stats=ao,at.count=function(){var c,b,a;if(bi){throw bi}return(c=bS(),b=!1,bc)?(i7(function(){c.resolve(br)}),c.promise()):(a=ap.count(function(d){a=null,ao.counts++,c.resolve(d)},function(d){a=null,c.reject(bx(d,{canceled:b}))}),bx(c.promise(),{cancel:function(){a&&(b=!0,a.abort(),a=null)}}))},at.clear=function(){if(bi){throw bi}if(bo.length===0){var b=bS(),a=new cB(n,b,!1);return aw(a,bo),b.promise()}return bo[0].p},at.filterForward=function(c,b,a){return ad(c,b,a,!1)},at.filterBack=function(c,b,a){return ad(c,b,a,!0)},at.readRange=function(d,b){if(iN(d,"index"),iN(b,"count"),bi){throw bi}var a=bS(),c=new cB(al,a,!0,d,b,[],0);return aw(c,bp),bx(a.promise(),{cancel:function(){c.cancel()}})},at.ToObservable=at.toObservable=function(){if(!i8.Rx||!i8.Rx.Observable){throw {message:"Rx library not available - include rx.js"}}if(bi){throw bi}return i8.Rx.Observable.CreateWithDisposable(function(g){var b=!1,a=0,c=function(e){b||g.OnError(e)},d=function(i){if(!b){for(var f=0,e=i.length;f<e;f++){g.OnNext(i[f])}i.length<av?g.OnCompleted():(a+=av,at.readRange(a,av).then(d,c))}};return at.readRange(a,av).then(d,c),{Dispose:function(){b=!0}}})};var ai=function(a){return function(c){bi={message:a,error:c};for(var b=0,d=bp.length;b<d;b++){bp[b].fireRejected(bi)}for(b=0,d=bo.length;b<d;b++){bo[b].fireRejected(bi)}bp=bo=null}},bk=function(d){if(d!==af){af=d;for(var b=bo.concat(bp,ay),a=0,c=b.length;a<c;a++){b[a].run(af)}}},ba=function(){var a=new c5;return ar.clear(function(){bh=0,bc=!1,br=0,bg=0,bn=0,be=bd===0,ao={counts:0,netReads:0,prefetches:0,cacheReads:0},at.stats=ao,ar.close(),a.resolve()},function(b){a.reject(b)}),a},au=function(b){var a=i3(bo,b);a||(a=i3(bp,b),a||i3(ay,b)),ae--,bk(gz)},bb=function(d){var c=new c5,a=!1,b=ap.read(d,av,function(e){var f={i:d,c:e.length,d:e};c.resolve(f)},function(e){c.reject(e)});return bx(c,{cancel:function(){b&&(b.abort(),a=!0,b=null)}})},ad=function(f,bw,k,u){if(f=iZ(f),bw=iZ(bw),isNaN(f)){throw {message:"'index' must be a valid number.",index:f}}if(isNaN(bw)){throw {message:"'count' must be a valid number.",count:bw}}if(bi){throw bi}f=Math.max(f,0);var r=bS(),d=[],bu=!1,g=null,bv=function(c,a){bu||(bw>=0&&d.length>=bw?r.resolve(d):g=at.readRange(c,a).then(function(i){for(var h,e,cb,by,v=0,ca=i.length;v<ca&&(bw<0||d.length<bw);v++){h=u?ca-v-1:v,e=i[h],k(e)&&(cb={index:c+h,item:e},u?d.unshift(cb):d.push(cb))}!u&&i.length<a||u&&c<=0?r.resolve(d):(by=u?Math.max(c-av,0):c+a,bv(by,av))},function(e){r.reject(e)}))},w=T(f,f,av),bt=u?w.i:f,b=u?f-w.i+1:w.i+w.c-f;return bv(bt,b),bx(r.promise(),{cancel:function(){g&&g.cancel(),bu=!0}})},ag=function(){at.onidle&&ae===0&&at.onidle()},o=function(b){if(!bc&&ak!==0&&!be&&(ay.length===0||ay[0]&&ay[0].c!==-1)){var a=new cB(an,null,!0,b,ak,null,ak);aw(a,ay)}},aw=function(b,a){b.oncomplete=au,a.push(b),ae++,b.run(af)},s=function(d){var c=!1,b=bx(new c5,{cancel:function(){c=!0}}),a=ab(b,"Read page from store failure");return ar.contains(d,function(e){if(!c){if(e){ar.read(d,function(g,f){c||b.resolve(f!==iX,f)},a);return}b.resolve(!1)}},a),b},bs=function(k,c){var h=!1,b=bx(new c5,{cancel:function(){h=!0}}),d=ab(b,"Save page to store failure"),a=function(){b.resolve(!0)},g;return c.c>0?(g=jR(c),be=bd>=0&&bd<bh+g,be?a():ar.addOrUpdate(k,c,function(){ac(c,g),ah(a,d)},d)):(ac(c,0),ah(a,d)),b},ah=function(c,b){var a={actualCacheSize:bh,allDataLocal:bc,cacheSize:bd,collectionCount:br,highestSavedPage:bg,highestSavedPageSize:bn,pageSize:av,sourceId:ap.identifier,version:aa};ar.addOrUpdate("__settings",a,c,b)},ab=function(a){return function(){a.resolve(!1)}},ac=function(d,c){var b=d.c,a=d.i;b===0?bg===a-av&&(br=bg+bn):(bg=Math.max(bg,a),bg===a&&(bn=b),bh+=c,b<av&&!br&&(br=a+b)),bc||br!==bg+bn||(bc=!0)},t=function(e,c,b,d){var a=e.canceled&&c!==cH;return a&&c===gO&&d&&d.cancel&&d.cancel(),a},n=function(d,b,a){var c=d.transition;if(a!==b4){return bk(b4),!0}switch(b){case jd:c(m);break;case cH:ag();break;case m:ba().then(function(){d.complete()}),d.wait();break;default:return !1}return !0},an=function(g,c,b,a){var e,d;if(!t(g,c,b,a)){if(e=g.transition,b!==jZ){return b===b4?c!==gO&&g.cancel():b===gz&&bk(jZ),!0}switch(c){case jd:ay[0]===g&&e(bq,g.i);break;case d0:d=g.pending,d>0&&(d-=Math.min(d,a.c)),bc||d===0||a.c<av||be?g.complete():(g.pending=d,e(bq,a.i+av));break;default:return bl(g,c,b,a,!0)}}return !0},al=function(h,c,b,a){var e,g,d;if(!t(h,c,b,a)){if(e=h.transition,b!==eL&&c!==jd){return b===b4?c!==jd&&h.cancel():b!==ax&&bk(eL),!0}switch(c){case jd:(b===gz||b===jZ)&&(bk(eL),h.c>0?(g=T(h.i,h.c,av),e(bq,g.i)):e(d0,h));break;case d0:aM(h,a),d=h.d.length,h.c===d||a.c<av?(ao.cacheReads++,o(a.i+a.c),h.complete()):e(bq,a.i+av);break;default:return bl(h,c,b,a,!1)}}return !0},bl=function(c,l,d,a,k){var p=c.error,b=c.transition,e=c.wait,g;switch(l){case cH:ag();break;case bq:g=s(a).then(function(h,f){c.canceled||(h?b(d0,f):b(eY,a))});break;case eY:g=bb(a).then(function(f){c.canceled||(k?ao.prefetches++:ao.netReads++,b(jw,f))},p);break;case jw:d!==ax&&(bk(ax),g=bs(a.i,a).then(function(f){c.canceled||(!f&&k&&(c.pending=0),b(d0,a)),bk(gz)}));break;default:return !1}return g&&(c.canceled?g.cancel():c.s===l&&e(g)),!0};return ar.read("__settings",function(c,b){if(jV(b)){var a=b.version;if(!a||a.indexOf("1.")!==0){ai("Unsupported cache store version "+a)();return}av!==b.pageSize||ap.identifier!==b.sourceId?ba().then(function(){bk(gz)},ai("Unable to clear store during initialization")):(bh=b.actualCacheSize,bc=b.allDataLocal,bd=b.cacheSize,br=b.collectionCount,bg=b.highestSavedPage,bn=b.highestSavedPageSize,aa=a,bk(gz))}else{ah(function(){bk(gz)},ai("Unable to write settings during initialization."))}},ai("Unable to read settings from store.")),at},a0.createDataCache=function(a){if(cO(a.pageSize,"pageSize"),eD(a.cacheSize,"cacheSize"),eD(a.prefetchSize,"prefetchSize"),!jV(a.name)){throw {message:"Undefined or null name",options:a}}if(!jV(a.source)){throw {message:"Undefined source",options:a}}return new h6(a)}})(this);